---
AIGC:
    ContentProducer: Minimax Agent AI
    ContentPropagator: Minimax Agent AI
    Label: AIGC
    ProduceID: "00000000000000000000000000000000"
    PropagateID: "00000000000000000000000000000000"
    ReservedCode1: 3045022036f019083f9886f86f03f72e4bbafe20bc6078463b11ab15a5a7d8e82d258030022100a30ca76122a76b38d64591c210866ea8ca83027da1cfd7642cd19125fada078d
    ReservedCode2: 30450221009d1e2a2347d3ae96bd1d44af980308b30555d3f7f19524ee10feb37704850be2022022ffac033bd86b711e848a10a011875ca766c109ebbe015a70d10ed785702dad
---

# 中望CAD动态块查寻插件用户使用手册

## 目录
1. [概述](#概述)
2. [安装与配置](#安装与配置)
3. [快速入门](#快速入门)
4. [核心功能详解](#核心功能详解)
5. [高级功能](#高级功能)
6. [最佳实践](#最佳实践)
7. [常见问题](#常见问题)
8. [技术支持](#技术支持)

---

## 概述

### 插件简介
中望CAD动态块查寻插件是一个专为中望CAD设计的专业工具，提供了完整的动态块查寻参数和动作管理功能。该插件扩展了中望CAD的动态块编辑能力，使用户能够更加高效地创建和管理复杂的动态块。

### 主要功能
- **查寻参数创建**：支持创建和管理查寻参数点，设置参数属性
- **查寻动作管理**：创建查寻动作，关联参数和对象
- **查寻表管理**：可视化编辑查寻表，配置查寻特性
- **参数特性管理**：管理输入特性和查寻特性
- **智能UI界面**：现代化WPF界面，操作直观便捷

### 适用版本
- 中望CAD 2020 或更高版本
- 支持 Windows 10/11 (64位)

---

## 安装与配置

### 系统要求
**最低配置：**
- 操作系统：Windows 10 (64位) 或更高版本
- 中望CAD：2020版或更高版本
- .NET Framework：4.8
- 内存：4GB RAM
- 硬盘空间：500MB可用空间

**推荐配置：**
- 操作系统：Windows 11 (64位)
- 中望CAD：2024版或更高版本
- .NET Framework：4.8
- 内存：8GB RAM 或更高
- 硬盘空间：1GB可用空间

### 安装步骤

#### 1. 下载插件
- 从官方网站或授权渠道下载插件安装包
- 验证文件的完整性和数字签名

#### 2. 安装插件
```bash
# 方法一：图形界面安装
1. 右键点击下载的安装包
2. 选择"以管理员身份运行"
3. 按照安装向导完成安装

# 方法二：命令行安装
1. 打开命令提示符（管理员权限）
2. 运行安装程序：ZWDynLookup_Setup.exe
3. 按照提示完成安装
```

#### 3. 配置中望CAD
1. 启动中望CAD
2. 打开"选项"对话框（OP命令）
3. 在"文件"选项卡中，添加插件目录到"支持文件搜索路径"
4. 重启中望CAD

#### 4. 验证安装
1. 在命令行输入：`APPLOAD`
2. 查找并加载 `ZWDynLookup.dll` 文件
3. 输入命令：`ZWBPARAMETER`，如果显示帮助信息则安装成功

### 卸载插件
1. 在中望CAD中卸载插件：`APPLOAD` → 移除插件
2. 运行控制面板的"程序和功能"，卸载插件
3. 手动删除残留文件（可选）

---

## 快速入门

### 第一个动态块：创建简单查寻参数

让我们通过一个简单的例子来了解插件的基本使用方法。

#### 步骤1：进入块编辑器
1. 创建或打开一个图形文件
2. 输入命令：`BE`（块编辑器）
3. 选择"创建新块"
4. 输入块名称：`SimpleLookupBlock`
5. 指定块的基点
6. 选择要包含在块中的几何图形
7. 点击"确定"进入块编辑器

#### 步骤2：创建查寻参数
1. 在块编辑器中，输入命令：`ZWBPARAMETER`
2. 系统会显示参数属性设置对话框
3. 设置参数属性：
   - **参数名称**：`SizeParameter`（内部标识）
   - **参数标签**：尺寸参数（显示名称）
   - **参数说明**：用于控制块的尺寸参数（描述信息）
   - **夹点数量**：1（选择一个夹点）
   - **选项板显示**：是
4. 点击"确定"
5. 在图形中指定参数的位置
6. 查寻参数创建完成

#### 步骤3：创建查寻动作
1. 输入命令：`ZWBACTIONTOOL`
2. 选择"查寻动作(L)"选项
3. 提示"选择查寻参数"时，点击刚创建的参数
4. 提示"选择对象"时，选择要受参数影响的对象
5. 设置查寻值：
   - 添加查寻值：`Small`、`Medium`、`Large`
   - 设置默认值：`Medium`
6. 完成查寻动作创建

#### 步骤4：测试动态块
1. 输入命令：`BE`退出块编辑器
2. 插入创建的动态块
3. 点击块的夹点，可以看到查寻菜单
4. 选择不同的查寻值，观察块的变化

### 常用命令快捷方式

| 命令 | 全名 | 功能 | 快捷键 |
|------|------|------|--------|
| ZWBPARAMETER | 查寻参数 | 创建查寻参数 | 无 |
| ZWBACTIONTOOL | 查寻动作 | 创建查寻动作 | 无 |
| ZWBLOOKUPTABLE | 查寻表管理 | 管理查寻表 | 无 |
| ZWBPROPERTIES | 参数特性管理 | 管理参数特性 | 无 |

---

## 核心功能详解

### 1. 查寻参数功能

#### 创建查寻参数
查寻参数是动态块的核心组件，用于控制块的行为和属性。

**操作步骤：**
1. 进入块编辑器
2. 执行`ZWBPARAMETER`命令
3. 在参数属性对话框中设置参数信息
4. 指定参数在块中的位置

**参数属性说明：**

| 属性 | 说明 | 示例 |
|------|------|------|
| 参数名称 | 内部唯一标识符，用于程序引用 | `LengthParam` |
| 参数标签 | 用户界面显示的名称 | 长度参数 |
| 参数说明 | 参数用途的详细描述 | 控制对象长度的参数 |
| 夹点数量 | 参数的可拖拽夹点数量（0或1） | 1 |
| 选项板显示 | 是否在参数选项板中显示此参数 | 是/否 |

#### 参数管理功能

**查找参数：**
```csharp
// 通过名称查找参数
var parameter = ParameterPointManager.FindParameterByName("LengthParam");

// 通过位置查找参数
var parameters = ParameterPointManager.FindParametersByLocation(point);
```

**参数验证：**
- 参数名称唯一性检查
- 参数位置冲突检测
- 参数完整性验证

**参数统计：**
- 当前块中的参数数量
- 参数类型分布
- 参数有效性分析

### 2. 查寻动作功能

#### 创建查寻动作
查寻动作将查寻参数与对象关联，实现动态变化效果。

**操作流程：**
1. 执行`ZWBACTIONTOOL`命令
2. 选择"查寻动作(L)"选项
3. 选择关联的查寻参数
4. 选择受动作影响的对象
5. 设置查寻值和属性
6. 完成动作创建

**查寻动作属性：**

| 属性 | 说明 | 选项 |
|------|------|------|
| 动作名称 | 动作的唯一标识符 | `MoveAction` |
| 动作标签 | 显示在界面上的名称 | 移动动作 |
| 查寻值列表 | 可供选择的值 | `Small`, `Medium`, `Large` |
| 默认值 | 默认选择的查寻值 | `Medium` |
| 启用状态 | 是否启用此动作 | 是/否 |

#### 选择集管理

**创建选择集：**
1. 执行`ZWBACTIONTOOL`命令
2. 选择"管理选择集(M)"选项
3. 选择要包含的对象
4. 为选择集命名
5. 保存选择集

**选择集操作：**
- 重命名选择集
- 删除选择集
- 编辑选择集内容
- 查看选择集统计信息

### 3. 查寻表管理

#### 查寻表编辑器
查寻表用于定义查寻参数与特性值之间的对应关系。

**打开查寻表编辑器：**
1. 执行`ZWBLOOKUPTABLE`命令
2. 系统打开查寻表管理对话框

**查寻表结构：**

| 列类型 | 说明 | 示例 |
|--------|------|------|
| 输入特性 | 用户输入的查寻值 | `Small`, `Medium`, `Large` |
| 查寻特性 | 对应的查寻结果值 | `100`, `200`, `300` |
| 显示值 | 用户界面显示的值 | `小号`, `中号`, `大号` |

#### 查寻特性管理

**添加查寻特性：**
1. 在查寻表编辑器中，点击"添加特性"
2. 输入特性名称（如：`尺寸`）
3. 设置特性值和显示值
4. 点击"确定"保存

**特性类型：**
- **文本特性**：字符串类型的特性值
- **数值特性**：数字类型的特性值
- **布尔特性**：true/false类型的特性值

### 4. 参数特性管理

#### 特性类型

**输入特性：**
- 用户在查寻时可以选择的输入值
- 支持多种数据类型
- 可以设置验证规则

**查寻特性：**
- 根据输入特性自动计算或查寻的输出值
- 支持公式计算
- 可以引用其他特性的值

#### 特性编辑器

**打开特性编辑器：**
1. 执行`ZWBPROPERTIES`命令
2. 选择要编辑的参数
3. 系统打开特性管理对话框

**特性操作：**
- 添加新特性
- 编辑现有特性
- 删除特性
- 复制特性
- 批量导入/导出特性

---

## 高级功能

### 1. 批量操作

#### 批量创建参数
```csharp
// 使用批量创建功能
var parameters = new[]
{
    new ParameterInfo { Name = "Width", Label = "宽度", Description = "对象宽度" },
    new ParameterInfo { Name = "Height", Label = "高度", Description = "对象高度" },
    new ParameterInfo { Name = "Color", Label = "颜色", Description = "对象颜色" }
};

LookupParameterCreator.BatchCreateParameters(parameters);
```

#### 批量属性设置
- 一次性设置多个参数的属性
- 批量复制参数特性
- 批量验证参数完整性

### 2. 模板功能

#### 参数模板
- 预定义的参数配置模板
- 支持自定义参数模板
- 快速应用常用参数设置

#### 动作模板
- 预定义的查寻动作配置
- 支持不同类型的动作模板
- 提高创建效率

### 3. 导入导出

#### 项目导出
```csharp
// 导出动态块项目
var exporter = new ProjectExporter();
exporter.ExportToFile("MyDynamicBlock.zwb", includeProperties: true);

// 导入动态块项目
var importer = new ProjectImporter();
var project = importer.ImportFromFile("MyDynamicBlock.zwb");
```

#### 配置同步
- 在不同计算机间同步插件配置
- 支持配置文件版本管理
- 增量更新机制

### 4. 自定义扩展

#### 开发自定义功能
```csharp
// 创建自定义查寻动作
public class CustomLookupAction : BaseLookupAction
{
    public override void Execute()
    {
        // 自定义执行逻辑
        CustomActionLogic();
    }
}
```

#### 插件API扩展
- 支持第三方插件开发
- 完整的API文档
- 示例代码和SDK

---

## 最佳实践

### 1. 命名约定

#### 参数命名
- 使用有意义的名称：`WidthParam` 而不是 `P1`
- 采用驼峰命名法：`lengthParameter`
- 避免特殊字符和空格

#### 动作命名
- 描述动作的用途：`ScaleAction` 而不是 `Action1`
- 区分不同类型的动作：`RotateAction`, `MoveAction`

### 2. 性能优化

#### 参数数量控制
- 单个块中的参数数量建议不超过50个
- 避免过度的参数关联
- 使用参数分组管理

#### 选择集优化
- 选择集不宜过大，建议单个选择集不超过100个对象
- 合理使用选择集重用
- 及时清理不需要的选择集

### 3. 维护建议

#### 定期备份
- 定期备份动态块项目文件
- 使用版本控制管理项目
- 备份重要的查寻表配置

#### 性能监控
- 监控插件运行性能
- 定期检查日志文件
- 及时更新插件版本

### 4. 错误预防

#### 输入验证
- 验证参数名称的唯一性
- 检查参数位置的合理性
- 验证特性值的有效性

#### 一致性检查
- 检查参数与动作的关联性
- 验证查寻表的完整性
- 确保特性引用正确

---

## 常见问题

### 安装和配置问题

**Q: 插件安装后无法加载？**
A: 请检查以下几点：
1. 确认中望CAD版本兼容性
2. 检查.NET Framework版本
3. 验证插件文件完整性
4. 以管理员权限运行安装程序

**Q: 命令找不到？**
A: 可能的原因和解决方法：
1. 插件未正确加载 → 重新加载插件
2. 命令名称错误 → 使用完整命令名
3. 权限不足 → 以管理员权限运行

**Q: 界面显示异常？**
A: 解决方案：
1. 重启中望CAD
2. 更新显卡驱动程序
3. 检查系统兼容性
4. 重新安装插件

### 使用问题

**Q: 创建参数时提示"参数名称重复"？**
A: 
1. 检查当前块中是否已有同名参数
2. 使用唯一的参数名称
3. 可以通过"查找参数"功能查看现有参数

**Q: 查寻动作无法触发？**
A: 检查项目：
1. 确认参数与动作正确关联
2. 验证查寻值设置正确
3. 检查动作是否启用
4. 查看对象是否在选择集内

**Q: 查寻表编辑失败？**
A: 可能的原因：
1. 查寻表被其他操作锁定
2. 权限不足
3. 文件格式错误
4. 数据验证失败

### 性能问题

**Q: 插件运行缓慢？**
A: 优化建议：
1. 减少同时打开的对话框数量
2. 清理不需要的选择集
3. 降低图形复杂度
4. 增加系统内存

**Q: 内存占用过高？**
A: 解决方法：
1. 定期重启中望CAD
2. 关闭不需要的功能模块
3. 优化参数结构
4. 清理临时文件

### 数据问题

**Q: 项目文件损坏？**
A: 恢复步骤：
1. 使用备份文件恢复
2. 检查磁盘错误
3. 重新导入项目
4. 联系技术支持

**Q: 查寻数据丢失？**
A: 数据恢复：
1. 检查自动备份
2. 查看临时文件
3. 从历史版本恢复
4. 手动重建查寻表

---

## 技术支持

### 获取帮助

**在线资源：**
- 官方网站：https://www.zwcad.com/plugins/zwdynlookup
- 用户手册：https://docs.zwdynlookup.com
- 视频教程：https://tutorials.zwdynlookup.com
- 社区论坛：https://forum.zwdynlookup.com

**技术支持：**
- 邮箱支持：support@zwdynlookup.com
- 在线客服：工作日 9:00-18:00
- 电话支持：400-XXX-XXXX
- 远程协助：预约制服务

### 反馈问题

**问题报告模板：**
```
问题标题：[简要描述问题]
问题类型：[功能异常/性能问题/安装问题/其他]
中望CAD版本：[例如：2024]
插件版本：[例如：1.2.0]
操作系统：[例如：Windows 11]
问题描述：
[详细描述问题现象]

重现步骤：
1. [步骤1]
2. [步骤2]
3. [步骤3]

期望结果：[描述期望的正确行为]
实际结果：[描述实际发生的错误]

附加信息：
- 错误截图
- 日志文件
- 配置文件
```

### 版本更新

**更新检查：**
- 启动时自动检查更新
- 手动检查更新命令：`ZWBUPDATE`
- 更新日志和发布说明

**更新类型：**
- **补丁更新**：修复小问题，不改变功能
- **功能更新**：新增功能，改进用户体验
- **重大更新**：架构改变，可能需要迁移

### 培训服务

**培训课程：**
- 基础入门培训（2小时）
- 高级功能培训（4小时）
- 定制化培训（按需安排）
- 企业内训服务

**培训内容：**
- 插件安装配置
- 基本功能操作
- 高级功能应用
- 最佳实践分享
- 问题解决方案

---

## 附录

### A. 快捷键列表

| 操作 | 快捷键 | 说明 |
|------|--------|------|
| 创建查寻参数 | ZWBPARAMETER | 快速创建查寻参数 |
| 创建查寻动作 | ZWBACTIONTOOL | 快速创建查寻动作 |
| 管理查寻表 | ZWBLOOKUPTABLE | 打开查寻表管理器 |
| 管理参数特性 | ZWBPROPERTIES | 打开特性管理器 |
| 查找参数 | ZWBFINDPARAM | 查找指定参数 |
| 批量操作 | ZWBBATCH | 批量操作工具 |

### B. 文件格式说明

**项目文件格式：**
- `.zwb` - 中望CAD动态块项目文件
- `.zwt` - 查寻表模板文件
- `.zwcfg` - 插件配置文件
- `.zwlog` - 插件日志文件

### C. 配置选项

**插件配置选项：**
```xml
<Configuration>
  <General>
    <AutoSave>true</AutoSave>
    <LogLevel>Info</LogLevel>
    <Language>zh-CN</Language>
  </General>
  <UI>
    <Theme>Light</Theme>
    <ShowTooltips>true</ShowTooltips>
    <ConfirmActions>true</ConfirmActions>
  </UI>
  <Performance>
    <MaxParameters>50</MaxParameters>
    <MaxSelectionSets>20</MaxSelectionSets>
  </Performance>
</Configuration>
```

---

**文档版本：** 1.0  
**最后更新：** 2024年12月  
**维护者：** 中望CAD动态块查寻插件开发团队