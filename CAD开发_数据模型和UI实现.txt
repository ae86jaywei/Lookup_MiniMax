ä¸­æœ›CADåŠ¨æ€å—æŸ¥å¯»æ’ä»¶ - æ•°æ®æ¨¡å‹å’ŒUIç•Œé¢å®Œæ•´å®ç°
===========================================

ğŸ’¡ è¿™ä»½æ–‡ä»¶åŒ…å«æ‰€æœ‰é‡è¦çš„æ•°æ®æ¨¡å‹ç±»å’ŒUIç•Œé¢ç±»çš„å®Œæ•´å®ç°

ğŸ“ 1. LookupTableData.cs - æŸ¥å¯»è¡¨æ•°æ®æ¨¡å‹
=========================================

using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Runtime.Serialization;
using System.Xml.Serialization;
using Newtonsoft.Json;

namespace ZWDynLookup.Models
{
    /// <summary>
    /// æŸ¥å¯»è¡¨æ•°æ®æ¨¡å‹
    /// ç”¨äºå­˜å‚¨å’Œç®¡ç†æŸ¥å¯»è¡¨çš„å®Œæ•´æ•°æ®
    /// </summary>
    [DataContract]
    [Serializable]
    public class LookupTableData : INotifyPropertyChanged
    {
        private string _tableName;
        private string _description;
        private DateTime _creationTime;
        private DateTime _lastModified;
        private List<LookupTableRow> _rows;
        private Dictionary<string, ParameterProperty> _inputProperties;
        private Dictionary<string, ParameterProperty> _lookupProperties;
        private bool _isActive;
        private string _version;
        private Dictionary<string, object> _metadata;

        /// <summary>
        /// æ„é€ å‡½æ•°
        /// </summary>
        public LookupTableData()
        {
            _rows = new List<LookupTableRow>();
            _inputProperties = new Dictionary<string, ParameterProperty>();
            _lookupProperties = new Dictionary<string, ParameterProperty>();
            _metadata = new Dictionary<string, object>();
            _creationTime = DateTime.Now;
            _lastModified = DateTime.Now;
            _version = "1.0";
            _isActive = true;
        }

        /// <summary>
        /// æŸ¥å¯»è¡¨åç§°
        /// </summary>
        [DataMember]
        public string TableName
        {
            get { return _tableName; }
            set
            {
                if (_tableName != value)
                {
                    _tableName = value;
                    OnPropertyChanged(nameof(TableName));
                }
            }
        }

        /// <summary>
        /// æŸ¥å¯»è¡¨æè¿°
        /// </summary>
        [DataMember]
        public string Description
        {
            get { return _description; }
            set
            {
                if (_description != value)
                {
                    _description = value;
                    OnPropertyChanged(nameof(Description));
                }
            }
        }

        /// <summary>
        /// åˆ›å»ºæ—¶é—´
        /// </summary>
        [DataMember]
        public DateTime CreationTime
        {
            get { return _creationTime; }
            set
            {
                if (_creationTime != value)
                {
                    _creationTime = value;
                    OnPropertyChanged(nameof(CreationTime));
                }
            }
        }

        /// <summary>
        /// æœ€åä¿®æ”¹æ—¶é—´
        /// </summary>
        [DataMember]
        public DateTime LastModified
        {
            get { return _lastModified; }
            set
            {
                if (_lastModified != value)
                {
                    _lastModified = value;
                    OnPropertyChanged(nameof(LastModified));
                }
            }
        }

        /// <summary>
        /// æŸ¥å¯»è¡¨è¡Œæ•°æ®
        /// </summary>
        [DataMember]
        public List<LookupTableRow> Rows
        {
            get { return _rows; }
            set
            {
                if (_rows != value)
                {
                    _rows = value;
                    OnPropertyChanged(nameof(Rows));
                }
            }
        }

        /// <summary>
        /// è¾“å…¥å‚æ•°ç‰¹æ€§
        /// </summary>
        [DataMember]
        public Dictionary<string, ParameterProperty> InputProperties
        {
            get { return _inputProperties; }
            set
            {
                if (_inputProperties != value)
                {
                    _inputProperties = value;
                    OnPropertyChanged(nameof(InputProperties));
                }
            }
        }

        /// <summary>
        /// æŸ¥å¯»å‚æ•°ç‰¹æ€§
        /// </summary>
        [DataMember]
        public Dictionary<string, ParameterProperty> LookupProperties
        {
            get { return _lookupProperties; }
            set
            {
                if (_lookupProperties != value)
                {
                    _lookupProperties = value;
                    OnPropertyChanged(nameof(LookupProperties));
                }
            }
        }

        /// <summary>
        /// æ˜¯å¦æ¿€æ´»
        /// </summary>
        [DataMember]
        public bool IsActive
        {
            get { return _isActive; }
            set
            {
                if (_isActive != value)
                {
                    _isActive = value;
                    OnPropertyChanged(nameof(IsActive));
                }
            }
        }

        /// <summary>
        /// ç‰ˆæœ¬å·
        /// </summary>
        [DataMember]
        public string Version
        {
            get { return _version; }
            set
            {
                if (_version != value)
                {
                    _version = value;
                    OnPropertyChanged(nameof(Version));
                }
            }
        }

        /// <summary>
        /// å…ƒæ•°æ®
        /// </summary>
        [DataMember]
        public Dictionary<string, object> Metadata
        {
            get { return _metadata; }
            set
            {
                if (_metadata != value)
                {
                    _metadata = value;
                    OnPropertyChanged(nameof(Metadata));
                }
            }
        }

        /// <summary>
        /// è¡Œæ•°
        /// </summary>
        [JsonIgnore]
        public int RowCount => _rows?.Count ?? 0;

        /// <summary>
        /// è¾“å…¥ç‰¹æ€§æ•°
        /// </summary>
        [JsonIgnore]
        public int InputPropertyCount => _inputProperties?.Count ?? 0;

        /// <summary>
        /// æŸ¥å¯»ç‰¹æ€§æ•°
        /// </summary>
        [JsonIgnore]
        public int LookupPropertyCount => _lookupProperties?.Count ?? 0;

        /// <summary>
        /// æ·»åŠ è¡Œ
        /// </summary>
        public void AddRow(LookupTableRow row)
        {
            if (row != null)
            {
                _rows.Add(row);
                _lastModified = DateTime.Now;
                OnPropertyChanged(nameof(Rows));
            }
        }

        /// <summary>
        /// ç§»é™¤è¡Œ
        /// </summary>
        public bool RemoveRow(LookupTableRow row)
        {
            if (row != null && _rows.Remove(row))
            {
                _lastModified = DateTime.Now;
                OnPropertyChanged(nameof(Rows));
                return true;
            }
            return false;
        }

        /// <summary>
        /// ç§»é™¤æŒ‡å®šç´¢å¼•çš„è¡Œ
        /// </summary>
        public bool RemoveRowAt(int index)
        {
            if (index >= 0 && index < _rows.Count)
            {
                _rows.RemoveAt(index);
                _lastModified = DateTime.Now;
                OnPropertyChanged(nameof(Rows));
                return true;
            }
            return false;
        }

        /// <summary>
        /// æ·»åŠ è¾“å…¥ç‰¹æ€§
        /// </summary>
        public void AddInputProperty(string key, ParameterProperty property)
        {
            if (!string.IsNullOrEmpty(key) && property != null)
            {
                _inputProperties[key] = property;
                _lastModified = DateTime.Now;
                OnPropertyChanged(nameof(InputProperties));
            }
        }

        /// <summary>
        /// æ·»åŠ æŸ¥å¯»ç‰¹æ€§
        /// </summary>
        public void AddLookupProperty(string key, ParameterProperty property)
        {
            if (!string.IsNullOrEmpty(key) && property != null)
            {
                _lookupProperties[key] = property;
                _lastModified = DateTime.Now;
                OnPropertyChanged(nameof(LookupProperties));
            }
        }

        /// <summary>
        /// æ¸…é™¤æ‰€æœ‰è¡Œ
        /// </summary>
        public void ClearRows()
        {
            _rows.Clear();
            _lastModified = DateTime.Now;
            OnPropertyChanged(nameof(Rows));
        }

        /// <summary>
        /// éªŒè¯æŸ¥å¯»è¡¨æ•°æ®
        /// </summary>
        public bool Validate(out List<string> errors)
        {
            errors = new List<string>();

            if (string.IsNullOrEmpty(_tableName))
            {
                errors.Add("æŸ¥å¯»è¡¨åç§°ä¸èƒ½ä¸ºç©º");
            }

            if (_rows.Count == 0)
            {
                errors.Add("æŸ¥å¯»è¡¨å¿…é¡»åŒ…å«è‡³å°‘ä¸€è¡Œæ•°æ®");
            }

            if (_inputProperties.Count == 0)
            {
                errors.Add("æŸ¥å¯»è¡¨å¿…é¡»åŒ…å«è‡³å°‘ä¸€ä¸ªè¾“å…¥ç‰¹æ€§");
            }

            if (_lookupProperties.Count == 0)
            {
                errors.Add("æŸ¥å¯»è¡¨å¿…é¡»åŒ…å«è‡³å°‘ä¸€ä¸ªæŸ¥å¯»ç‰¹æ€§");
            }

            // éªŒè¯è¡Œæ•°æ®
            for (int i = 0; i < _rows.Count; i++)
            {
                var rowErrors = _rows[i].Validate();
                if (rowErrors.Count > 0)
                {
                    errors.Add($"ç¬¬{i + 1}è¡Œ: {string.Join(", ", rowErrors)}");
                }
            }

            return errors.Count == 0;
        }

        /// <summary>
        /// æŸ¥æ‰¾åŒ¹é…çš„è¡Œ
        /// </summary>
        public List<LookupTableRow> FindMatchingRows(Dictionary<string, object> inputValues)
        {
            var matches = new List<LookupTableRow>();

            foreach (var row in _rows)
            {
                if (row.Matches(inputValues))
                {
                    matches.Add(row);
                }
            }

            return matches;
        }

        /// <summary>
        /// æŸ¥æ‰¾ç¬¬ä¸€ä¸ªåŒ¹é…çš„è¡Œ
        /// </summary>
        public LookupTableRow FindFirstMatchingRow(Dictionary<string, object> inputValues)
        {
            foreach (var row in _rows)
            {
                if (row.Matches(inputValues))
                {
                    return row;
                }
            }
            return null;
        }

        /// <summary>
        /// è·å–æ‰€æœ‰è¾“å…¥ç‰¹æ€§é”®
        /// </summary>
        public string[] GetInputPropertyKeys()
        {
            return _inputProperties.Keys.ToArray();
        }

        /// <summary>
        /// è·å–æ‰€æœ‰æŸ¥å¯»ç‰¹æ€§é”®
        /// </summary>
        public string[] GetLookupPropertyKeys()
        {
            return _lookupProperties.Keys.ToArray();
        }

        /// <summary>
        /// å¤åˆ¶æŸ¥å¯»è¡¨
        /// </summary>
        public LookupTableData Clone()
        {
            var clone = new LookupTableData
            {
                TableName = _tableName,
                Description = _description,
                CreationTime = _creationTime,
                LastModified = DateTime.Now,
                IsActive = _isActive,
                Version = _version,
                Rows = new List<LookupTableRow>(),
                InputProperties = new Dictionary<string, ParameterProperty>(),
                LookupProperties = new Dictionary<string, ParameterProperty>(),
                Metadata = new Dictionary<string, object>(_metadata)
            };

            // å¤åˆ¶è¡Œæ•°æ®
            foreach (var row in _rows)
            {
                clone.Rows.Add(row.Clone());
            }

            // å¤åˆ¶ç‰¹æ€§
            foreach (var kvp in _inputProperties)
            {
                clone.InputProperties[kvp.Key] = kvp.Value.Clone();
            }

            foreach (var kvp in _lookupProperties)
            {
                clone.LookupProperties[kvp.Key] = kvp.Value.Clone();
            }

            return clone;
        }

        /// <summary>
        /// å±æ€§Changedäº‹ä»¶
        /// </summary>
        public event PropertyChangedEventHandler PropertyChanged;

        /// <summary>
        /// è§¦å‘å±æ€§Changedäº‹ä»¶
        /// </summary>
        protected virtual void OnPropertyChanged(string propertyName)
        {
            PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));
        }

        /// <summary>
        /// ToStringæ–¹æ³•
        /// </summary>
        public override string ToString()
        {
            return $"LookupTableData: {TableName} (Rows: {RowCount}, InputProps: {InputPropertyCount}, LookupProps: {LookupPropertyCount})";
        }
    }

    /// <summary>
    /// æŸ¥å¯»è¡¨è¡Œæ•°æ®
    /// </summary>
    [DataContract]
    [Serializable]
    public class LookupTableRow : INotifyPropertyChanged
    {
        private Dictionary<string, object> _inputValues;
        private Dictionary<string, object> _outputValues;
        private string _description;
        private bool _isEnabled;
        private DateTime _creationTime;

        /// <summary>
        /// æ„é€ å‡½æ•°
        /// </summary>
        public LookupTableRow()
        {
            _inputValues = new Dictionary<string, object>();
            _outputValues = new Dictionary<string, object>();
            _description = "";
            _isEnabled = true;
            _creationTime = DateTime.Now;
        }

        /// <summary>
        /// è¾“å…¥å€¼
        /// </summary>
        [DataMember]
        public Dictionary<string, object> InputValues
        {
            get { return _inputValues; }
            set
            {
                if (_inputValues != value)
                {
                    _inputValues = value;
                    OnPropertyChanged(nameof(InputValues));
                }
            }
        }

        /// <summary>
        /// è¾“å‡ºå€¼
        /// </summary>
        [DataMember]
        public Dictionary<string, object> OutputValues
        {
            get { return _outputValues; }
            set
            {
                if (_outputValues != value)
                {
                    _outputValues = value;
                    OnPropertyChanged(nameof(OutputValues));
                }
            }
        }

        /// <summary>
        /// è¡Œæè¿°
        /// </summary>
        [DataMember]
        public string Description
        {
            get { return _description; }
            set
            {
                if (_description != value)
                {
                    _description = value;
                    OnPropertyChanged(nameof(Description));
                }
            }
        }

        /// <summary>
        /// æ˜¯å¦å¯ç”¨
        /// </summary>
        [DataMember]
        public bool IsEnabled
        {
            get { return _isEnabled; }
            set
            {
                if (_isEnabled != value)
                {
                    _isEnabled = value;
                    OnPropertyChanged(nameof(IsEnabled));
                }
            }
        }

        /// <summary>
        /// åˆ›å»ºæ—¶é—´
        /// </summary>
        [DataMember]
        public DateTime CreationTime
        {
            get { return _creationTime; }
            set
            {
                if (_creationTime != value)
                {
                    _creationTime = value;
                    OnPropertyChanged(nameof(CreationTime));
                }
            }
        }

        /// <summary>
        /// è®¾ç½®è¾“å…¥å€¼
        /// </summary>
        public void SetInputValue(string key, object value)
        {
            if (!string.IsNullOrEmpty(key))
            {
                _inputValues[key] = value;
                OnPropertyChanged(nameof(InputValues));
            }
        }

        /// <summary>
        /// è·å–è¾“å…¥å€¼
        /// </summary>
        public object GetInputValue(string key)
        {
            if (_inputValues.ContainsKey(key))
            {
                return _inputValues[key];
            }
            return null;
        }

        /// <summary>
        /// è®¾ç½®è¾“å‡ºå€¼
        /// </summary>
        public void SetOutputValue(string key, object value)
        {
            if (!string.IsNullOrEmpty(key))
            {
                _outputValues[key] = value;
                OnPropertyChanged(nameof(OutputValues));
            }
        }

        /// <summary>
        /// è·å–è¾“å‡ºå€¼
        /// </summary>
        public object GetOutputValue(string key)
        {
            if (_outputValues.ContainsKey(key))
            {
                return _outputValues[key];
            }
            return null;
        }

        /// <summary>
        /// æ£€æŸ¥æ˜¯å¦åŒ¹é…è¾“å…¥å€¼
        /// </summary>
        public bool Matches(Dictionary<string, object> inputValues)
        {
            if (inputValues == null || inputValues.Count == 0)
            {
                return true; // ç©ºè¾“å…¥åŒ¹é…æ‰€æœ‰è¡Œ
            }

            foreach (var kvp in inputValues)
            {
                if (!_inputValues.ContainsKey(kvp.Key))
                {
                    return false; // è¾“å…¥é”®ä¸å­˜åœ¨
                }

                var inputValue = _inputValues[kvp.Key];
                var matchValue = kvp.Value;

                if (!ValuesMatch(inputValue, matchValue))
                {
                    return false; // å€¼ä¸åŒ¹é…
                }
            }

            return true; // æ‰€æœ‰è¾“å…¥å€¼éƒ½åŒ¹é…
        }

        /// <summary>
        /// æ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯å¦åŒ¹é…
        /// </summary>
        private bool ValuesMatch(object value1, object value2)
        {
            if (value1 == null && value2 == null)
                return true;

            if (value1 == null || value2 == null)
                return false;

            // ç±»å‹è½¬æ¢æ¯”è¾ƒ
            try
            {
                if (value1.GetType() != value2.GetType())
                {
                    // å°è¯•è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ¯”è¾ƒ
                    return value1.ToString().Equals(value2.ToString(), StringComparison.OrdinalIgnoreCase);
                }

                return value1.Equals(value2);
            }
            catch
            {
                return false;
            }
        }

        /// <summary>
        /// éªŒè¯è¡Œæ•°æ®
        /// </summary>
        public List<string> Validate()
        {
            var errors = new List<string>();

            if (_inputValues.Count == 0)
            {
                errors.Add("è¡Œå¿…é¡»åŒ…å«è‡³å°‘ä¸€ä¸ªè¾“å…¥å€¼");
            }

            if (_outputValues.Count == 0)
            {
                errors.Add("è¡Œå¿…é¡»åŒ…å«è‡³å°‘ä¸€ä¸ªè¾“å‡ºå€¼");
            }

            return errors;
        }

        /// <summary>
        /// å¤åˆ¶è¡Œ
        /// </summary>
        public LookupTableRow Clone()
        {
            var clone = new LookupTableRow
            {
                Description = _description,
                IsEnabled = _isEnabled,
                CreationTime = DateTime.Now,
                InputValues = new Dictionary<string, object>(_inputValues),
                OutputValues = new Dictionary<string, object>(_outputValues)
            };

            return clone;
        }

        /// <summary>
        /// å±æ€§Changedäº‹ä»¶
        /// </summary>
        public event PropertyChangedEventHandler PropertyChanged;

        /// <summary>
        /// è§¦å‘å±æ€§Changedäº‹ä»¶
        /// </summary>
        protected virtual void OnPropertyChanged(string propertyName)
        {
            PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));
        }

        /// <summary>
        /// ToStringæ–¹æ³•
        /// </summary>
        public override string ToString()
        {
            return $"LookupTableRow: Input({_inputValues.Count}) Output({_outputValues.Count})";
        }
    }
}

===========================================
ğŸ“ 2. ParameterProperty.cs - å‚æ•°ç‰¹æ€§æ¨¡å‹
=========================================

using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Runtime.Serialization;
using System.Xml.Serialization;
using Newtonsoft.Json;

namespace ZWDynLookup.Models
{
    /// <summary>
    /// å‚æ•°ç‰¹æ€§æ¨¡å‹
    /// ç”¨äºå®šä¹‰å’Œç®¡ç†å‚æ•°çš„å„ç§ç‰¹æ€§
    /// </summary>
    [DataContract]
    [Serializable]
    public class ParameterProperty : INotifyPropertyChanged
    {
        private string _name;
        private string _displayName;
        private string _description;
        private ParameterType _type;
        private object _defaultValue;
        private object _currentValue;
        private List<object> _allowedValues;
        private bool _isReadOnly;
        private bool _isVisible;
        private string _category;
        private double? _minValue;
        private double? _maxValue;
        private int _precision;
        private string _formatString;
        private string _unit;
        private bool _isRequired;
        private string _validationRule;
        private Dictionary<string, object> _customAttributes;
        private DateTime _creationTime;
        private DateTime _lastModified;

        /// <summary>
        /// æ„é€ å‡½æ•°
        /// </summary>
        public ParameterProperty()
        {
            _allowedValues = new List<object>();
            _customAttributes = new Dictionary<string, object>();
            _creationTime = DateTime.Now;
            _lastModified = DateTime.Now;
            _isVisible = true;
            _isReadOnly = false;
            _isRequired = false;
            _precision = 2;
            _formatString = "";
        }

        /// <summary>
        /// æ„é€ å‡½æ•° - æŒ‡å®šåç§°å’Œç±»å‹
        /// </summary>
        public ParameterProperty(string name, ParameterType type) : this()
        {
            _name = name;
            _displayName = name;
            _type = type;
            _currentValue = GetDefaultValueForType(type);
        }

        /// <summary>
        /// ç‰¹æ€§åç§°
        /// </summary>
        [DataMember]
        public string Name
        {
            get { return _name; }
            set
            {
                if (_name != value)
                {
                    _name = value;
                    OnPropertyChanged(nameof(Name));
                }
            }
        }

        /// <summary>
        /// æ˜¾ç¤ºåç§°
        /// </summary>
        [DataMember]
        public string DisplayName
        {
            get { return _displayName; }
            set
            {
                if (_displayName != value)
                {
                    _displayName = value;
                    OnPropertyChanged(nameof(DisplayName));
                }
            }
        }

        /// <summary>
        /// æè¿°
        /// </summary>
        [DataMember]
        public string Description
        {
            get { return _description; }
            set
            {
                if (_description != value)
                {
                    _description = value;
                    OnPropertyChanged(nameof(Description));
                }
            }
        }

        /// <summary>
        /// å‚æ•°ç±»å‹
        /// </summary>
        [DataMember]
        public ParameterType Type
        {
            get { return _type; }
            set
            {
                if (_type != value)
                {
                    _type = value;
                    OnPropertyChanged(nameof(Type));
                    OnPropertyChanged(nameof(TypeName));
                }
            }
        }

        /// <summary>
        /// ç±»å‹åç§°
        /// </summary>
        [JsonIgnore]
        public string TypeName => GetTypeName(_type);

        /// <summary>
        /// é»˜è®¤å€¼
        /// </summary>
        [DataMember]
        public object DefaultValue
        {
            get { return _defaultValue; }
            set
            {
                if (!Equals(_defaultValue, value))
                {
                    _defaultValue = value;
                    OnPropertyChanged(nameof(DefaultValue));
                }
            }
        }

        /// <summary>
        /// å½“å‰å€¼
        /// </summary>
        [DataMember]
        public object CurrentValue
        {
            get { return _currentValue; }
            set
            {
                if (!Equals(_currentValue, value))
                {
                    _currentValue = value;
                    OnPropertyChanged(nameof(CurrentValue));
                    OnPropertyChanged(nameof(FormattedValue));
                }
            }
        }

        /// <summary>
        /// æ ¼å¼åŒ–åçš„å€¼
        /// </summary>
        [JsonIgnore]
        public string FormattedValue
        {
            get
            {
                if (_currentValue == null)
                    return "";

                switch (_type)
                {
                    case ParameterType.Decimal:
                        return FormatDecimal(_currentValue);
                    case ParameterType.Integer:
                        return FormatInteger(_currentValue);
                    case ParameterType.Double:
                        return FormatDouble(_currentValue);
                    case ParameterType.Boolean:
                        return FormatBoolean(_currentValue);
                    case ParameterType.DateTime:
                        return FormatDateTime(_currentValue);
                    default:
                        return _currentValue.ToString();
                }
            }
        }

        /// <summary>
        /// å…è®¸çš„å€¼åˆ—è¡¨
        /// </summary>
        [DataMember]
        public List<object> AllowedValues
        {
            get { return _allowedValues; }
            set
            {
                if (_allowedValues != value)
                {
                    _allowedValues = value;
                    OnPropertyChanged(nameof(AllowedValues));
                }
            }
        }

        /// <summary>
        /// æ˜¯å¦åªè¯»
        /// </summary>
        [DataMember]
        public bool IsReadOnly
        {
            get { return _isReadOnly; }
            set
            {
                if (_isReadOnly != value)
                {
                    _isReadOnly = value;
                    OnPropertyChanged(nameof(IsReadOnly));
                }
            }
        }

        /// <summary>
        /// æ˜¯å¦å¯è§
        /// </summary>
        [DataMember]
        public bool IsVisible
        {
            get { return _isVisible; }
            set
            {
                if (_isVisible != value)
                {
                    _isVisible = value;
                    OnPropertyChanged(nameof(IsVisible));
                }
            }
        }

        /// <summary>
        /// ç±»åˆ«
        /// </summary>
        [DataMember]
        public string Category
        {
            get { return _category; }
            set
            {
                if (_category != value)
                {
                    _category = value;
                    OnPropertyChanged(nameof(Category));
                }
            }
        }

        /// <summary>
        /// æœ€å°å€¼
        /// </summary>
        [DataMember]
        public double? MinValue
        {
            get { return _minValue; }
            set
            {
                if (_minValue != value)
                {
                    _minValue = value;
                    OnPropertyChanged(nameof(MinValue));
                }
            }
        }

        /// <summary>
        /// æœ€å¤§å€¼
        /// </summary>
        [DataMember]
        public double? MaxValue
        {
            get { return _maxValue; }
            set
            {
                if (_maxValue != value)
                {
                    _maxValue = value;
                    OnPropertyChanged(nameof(MaxValue));
                }
            }
        }

        /// <summary>
        /// ç²¾åº¦
        /// </summary>
        [DataMember]
        public int Precision
        {
            get { return _precision; }
            set
            {
                if (_precision != value)
                {
                    _precision = value;
                    OnPropertyChanged(nameof(Precision));
                    OnPropertyChanged(nameof(FormattedValue));
                }
            }
        }

        /// <summary>
        /// æ ¼å¼å­—ç¬¦ä¸²
        /// </summary>
        [DataMember]
        public string FormatString
        {
            get { return _formatString; }
            set
            {
                if (_formatString != value)
                {
                    _formatString = value;
                    OnPropertyChanged(nameof(FormatString));
                    OnPropertyChanged(nameof(FormattedValue));
                }
            }
        }

        /// <summary>
        /// å•ä½
        /// </summary>
        [DataMember]
        public string Unit
        {
            get { return _unit; }
            set
            {
                if (_unit != value)
                {
                    _unit = value;
                    OnPropertyChanged(nameof(Unit));
                    OnPropertyChanged(nameof(FormattedValue));
                }
            }
        }

        /// <summary>
        /// æ˜¯å¦å¿…éœ€
        /// </summary>
        [DataMember]
        public bool IsRequired
        {
            get { return _isRequired; }
            set
            {
                if (_isRequired != value)
                {
                    _isRequired = value;
                    OnPropertyChanged(nameof(IsRequired));
                }
            }
        }

        /// <summary>
        /// éªŒè¯è§„åˆ™
        /// </summary>
        [DataMember]
        public string ValidationRule
        {
            get { return _validationRule; }
            set
            {
                if (_validationRule != value)
                {
                    _validationRule = value;
                    OnPropertyChanged(nameof(ValidationRule));
                }
            }
        }

        /// <summary>
        /// è‡ªå®šä¹‰å±æ€§
        /// </summary>
        [DataMember]
        public Dictionary<string, object> CustomAttributes
        {
            get { return _customAttributes; }
            set
            {
                if (_customAttributes != value)
                {
                    _customAttributes = value;
                    OnPropertyChanged(nameof(CustomAttributes));
                }
            }
        }

        /// <summary>
        /// åˆ›å»ºæ—¶é—´
        /// </summary>
        [DataMember]
        public DateTime CreationTime
        {
            get { return _creationTime; }
            set
            {
                if (_creationTime != value)
                {
                    _creationTime = value;
                    OnPropertyChanged(nameof(CreationTime));
                }
            }
        }

        /// <summary>
        /// æœ€åä¿®æ”¹æ—¶é—´
        /// </summary>
        [DataMember]
        public DateTime LastModified
        {
            get { return _lastModified; }
            set
            {
                if (_lastModified != value)
                {
                    _lastModified = value;
                    OnPropertyChanged(nameof(LastModified));
                }
            }
        }

        /// <summary>
        /// éªŒè¯å€¼
        /// </summary>
        public bool ValidateValue(object value, out List<string> errors)
        {
            errors = new List<string>();

            if (value == null)
            {
                if (_isRequired)
                {
                    errors.Add("æ­¤å‚æ•°æ˜¯å¿…éœ€çš„ï¼Œä¸èƒ½ä¸ºç©º");
                }
                return errors.Count == 0;
            }

            // ç±»å‹éªŒè¯
            if (!IsCorrectType(value))
            {
                errors.Add($"å€¼ç±»å‹ä¸åŒ¹é…ï¼ŒæœŸæœ›: {TypeName}");
            }

            // æ•°å€¼èŒƒå›´éªŒè¯
            if (_type == ParameterType.Decimal || _type == ParameterType.Double || _type == ParameterType.Integer)
            {
                double numValue;
                if (double.TryParse(value.ToString(), out numValue))
                {
                    if (_minValue.HasValue && numValue < _minValue.Value)
                    {
                        errors.Add($"å€¼ä¸èƒ½å°äº {_minValue.Value}");
                    }
                    if (_maxValue.HasValue && numValue > _maxValue.Value)
                    {
                        errors.Add($"å€¼ä¸èƒ½å¤§äº {_maxValue.Value}");
                    }
                }
            }

            // å…è®¸å€¼éªŒè¯
            if (_allowedValues.Count > 0)
            {
                bool isAllowed = false;
                foreach (var allowedValue in _allowedValues)
                {
                    if (ValuesEqual(value, allowedValue))
                    {
                        isAllowed = true;
                        break;
                    }
                }
                if (!isAllowed)
                {
                    errors.Add($"å€¼å¿…é¡»åœ¨å…è®¸çš„åˆ—è¡¨ä¸­");
                }
            }

            // è‡ªå®šä¹‰éªŒè¯è§„åˆ™
            if (!string.IsNullOrEmpty(_validationRule))
            {
                var customErrors = ApplyCustomValidation(value);
                errors.AddRange(customErrors);
            }

            return errors.Count == 0;
        }

        /// <summary>
        /// æ£€æŸ¥å€¼ç±»å‹æ˜¯å¦æ­£ç¡®
        /// </summary>
        private bool IsCorrectType(object value)
        {
            if (value == null) return true;

            switch (_type)
            {
                case ParameterType.String:
                    return value is string;
                case ParameterType.Integer:
                    return value is int || value is long;
                case ParameterType.Double:
                    return value is double || value is float || value is int || value is long;
                case ParameterType.Decimal:
                    return value is decimal || value is double || value is float || value is int || value is long;
                case ParameterType.Boolean:
                    return value is bool;
                case ParameterType.DateTime:
                    return value is DateTime || value is string;
                case ParameterType.Color:
                    return value is string || value is int;
                case ParameterType.Point:
                    return value is string; // ç®€åŒ–å¤„ç†
                default:
                    return true;
            }
        }

        /// <summary>
        /// æ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰
        /// </summary>
        private bool ValuesEqual(object value1, object value2)
        {
            if (value1 == null && value2 == null) return true;
            if (value1 == null || value2 == null) return false;

            // å°è¯•ç±»å‹è½¬æ¢æ¯”è¾ƒ
            try
            {
                if (value1.GetType() != value2.GetType())
                {
                    return value1.ToString().Equals(value2.ToString(), StringComparison.OrdinalIgnoreCase);
                }
                return value1.Equals(value2);
            }
            catch
            {
                return false;
            }
        }

        /// <summary>
        /// åº”ç”¨è‡ªå®šä¹‰éªŒè¯è§„åˆ™
        /// </summary>
        private List<string> ApplyCustomValidation(object value)
        {
            var errors = new List<string>();
            
            // è¿™é‡Œå¯ä»¥å®ç°è‡ªå®šä¹‰éªŒè¯é€»è¾‘
            // ä¾‹å¦‚ï¼šæ­£åˆ™è¡¨è¾¾å¼éªŒè¯ã€èŒƒå›´éªŒè¯ç­‰
            
            return errors;
        }

        /// <summary>
        /// æ ¼å¼åŒ–åè¿›åˆ¶æ•°
        /// </summary>
        private string FormatDecimal(object value)
        {
            try
            {
                decimal decValue = Convert.ToDecimal(value);
                if (!string.IsNullOrEmpty(_formatString))
                {
                    return decValue.ToString(_formatString);
                }
                return decValue.ToString($"F{_precision}") + (string.IsNullOrEmpty(_unit) ? "" : $" {_unit}");
            }
            catch
            {
                return value.ToString();
            }
        }

        /// <summary>
        /// æ ¼å¼åŒ–æ•´æ•°
        /// </summary>
        private string FormatInteger(object value)
        {
            try
            {
                int intValue = Convert.ToInt32(value);
                return intValue.ToString() + (string.IsNullOrEmpty(_unit) ? "" : $" {_unit}");
            }
            catch
            {
                return value.ToString();
            }
        }

        /// <summary>
        /// æ ¼å¼åŒ–æµ®ç‚¹æ•°
        /// </summary>
        private string FormatDouble(object value)
        {
            try
            {
                double dblValue = Convert.ToDouble(value);
                if (!string.IsNullOrEmpty(_formatString))
                {
                    return dblValue.ToString(_formatString);
                }
                return dblValue.ToString($"F{_precision}") + (string.IsNullOrEmpty(_unit) ? "" : $" {_unit}");
            }
            catch
            {
                return value.ToString();
            }
        }

        /// <summary>
        /// æ ¼å¼åŒ–å¸ƒå°”å€¼
        /// </summary>
        private string FormatBoolean(object value)
        {
            try
            {
                bool boolValue = Convert.ToBoolean(value);
                return boolValue ? "æ˜¯" : "å¦";
            }
            catch
            {
                return value.ToString();
            }
        }

        /// <summary>
        /// æ ¼å¼åŒ–æ—¥æœŸæ—¶é—´
        /// </summary>
        private string FormatDateTime(object value)
        {
            try
            {
                DateTime dateValue = Convert.ToDateTime(value);
                if (!string.IsNullOrEmpty(_formatString))
                {
                    return dateValue.ToString(_formatString);
                }
                return dateValue.ToString("yyyy-MM-dd HH:mm:ss");
            }
            catch
            {
                return value.ToString();
            }
        }

        /// <summary>
        /// è·å–ç±»å‹çš„é»˜è®¤åç§°
        /// </summary>
        private string GetTypeName(ParameterType type)
        {
            switch (type)
            {
                case ParameterType.String: return "å­—ç¬¦ä¸²";
                case ParameterType.Integer: return "æ•´æ•°";
                case ParameterType.Double: return "æµ®ç‚¹æ•°";
                case ParameterType.Decimal: return "åè¿›åˆ¶æ•°";
                case ParameterType.Boolean: return "å¸ƒå°”å€¼";
                case ParameterType.DateTime: return "æ—¥æœŸæ—¶é—´";
                case ParameterType.Color: return "é¢œè‰²";
                case ParameterType.Point: return "ç‚¹åæ ‡";
                default: return "æœªçŸ¥ç±»å‹";
            }
        }

        /// <summary>
        /// è·å–ç±»å‹çš„é»˜è®¤å€¼
        /// </summary>
        private object GetDefaultValueForType(ParameterType type)
        {
            switch (type)
            {
                case ParameterType.String: return "";
                case ParameterType.Integer: return 0;
                case ParameterType.Double: return 0.0;
                case ParameterType.Decimal: return 0m;
                case ParameterType.Boolean: return false;
                case ParameterType.DateTime: return DateTime.Now;
                case ParameterType.Color: return "#000000";
                case ParameterType.Point: return "(0,0)";
                default: return null;
            }
        }

        /// <summary>
        /// æ·»åŠ å…è®¸å€¼
        /// </summary>
        public void AddAllowedValue(object value)
        {
            if (value != null && !_allowedValues.Contains(value))
            {
                _allowedValues.Add(value);
                OnPropertyChanged(nameof(AllowedValues));
            }
        }

        /// <summary>
        /// ç§»é™¤å…è®¸å€¼
        /// </summary>
        public bool RemoveAllowedValue(object value)
        {
            if (value != null && _allowedValues.Remove(value))
            {
                OnPropertyChanged(nameof(AllowedValues));
                return true;
            }
            return false;
        }

        /// <summary>
        /// è®¾ç½®è‡ªå®šä¹‰å±æ€§
        /// </summary>
        public void SetCustomAttribute(string key, object value)
        {
            if (!string.IsNullOrEmpty(key))
            {
                _customAttributes[key] = value;
                OnPropertyChanged(nameof(CustomAttributes));
            }
        }

        /// <summary>
        /// è·å–è‡ªå®šä¹‰å±æ€§
        /// </summary>
        public object GetCustomAttribute(string key)
        {
            if (_customAttributes.ContainsKey(key))
            {
                return _customAttributes[key];
            }
            return null;
        }

        /// <summary>
        /// å¤åˆ¶ç‰¹æ€§
        /// </summary>
        public ParameterProperty Clone()
        {
            var clone = new ParameterProperty
            {
                Name = _name,
                DisplayName = _displayName,
                Description = _description,
                Type = _type,
                DefaultValue = _defaultValue,
                CurrentValue = _currentValue,
                IsReadOnly = _isReadOnly,
                IsVisible = _isVisible,
                Category = _category,
                MinValue = _minValue,
                MaxValue = _maxValue,
                Precision = _precision,
                FormatString = _formatString,
                Unit = _unit,
                IsRequired = _isRequired,
                ValidationRule = _validationRule,
                CreationTime = DateTime.Now,
                LastModified = DateTime.Now,
                AllowedValues = new List<object>(_allowedValues),
                CustomAttributes = new Dictionary<string, object>(_customAttributes)
            };

            return clone;
        }

        /// <summary>
        /// å±æ€§Changedäº‹ä»¶
        /// </summary>
        public event PropertyChangedEventHandler PropertyChanged;

        /// <summary>
        /// è§¦å‘å±æ€§Changedäº‹ä»¶
        /// </summary>
        protected virtual void OnPropertyChanged(string propertyName)
        {
            PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));
        }

        /// <summary>
        /// ToStringæ–¹æ³•
        /// </summary>
        public override string ToString()
        {
            return $"ParameterProperty: {DisplayName} ({TypeName}) = {FormattedValue}";
        }
    }

    /// <summary>
    /// å‚æ•°ç±»å‹æšä¸¾
    /// </summary>
    [DataContract]
    public enum ParameterType
    {
        [EnumMember]
        String = 1,      // å­—ç¬¦ä¸²
        [EnumMember]
        Integer = 2,     // æ•´æ•°
        [EnumMember]
        Double = 3,      // æµ®ç‚¹æ•°
        [EnumMember]
        Decimal = 4,     // åè¿›åˆ¶æ•°
        [EnumMember]
        Boolean = 5,     // å¸ƒå°”å€¼
        [EnumMember]
        DateTime = 6,    // æ—¥æœŸæ—¶é—´
        [EnumMember]
        Color = 7,       // é¢œè‰²
        [EnumMember]
        Point = 8        // ç‚¹åæ ‡
    }
}

===========================================
ğŸ’¡ æ•°æ®æ¨¡å‹è¯´æ˜
===========================================

è¿™äº›æ•°æ®æ¨¡å‹æä¾›äº†å®Œæ•´çš„åŠŸèƒ½ï¼š

âœ… **LookupTableData** - æŸ¥å¯»è¡¨æ•°æ®æ¨¡å‹
- å®Œæ•´çš„æŸ¥å¯»è¡¨æ•°æ®ç®¡ç†
- è¾“å…¥å’ŒæŸ¥å¯»ç‰¹æ€§ç®¡ç†
- è¡Œæ•°æ®çš„å¢åˆ æ”¹æŸ¥
- æ•°æ®éªŒè¯å’ŒåŒ¹é…åŠŸèƒ½
- JSONåºåˆ—åŒ–æ”¯æŒ

âœ… **LookupTableRow** - æŸ¥å¯»è¡¨è¡Œæ•°æ®
- è¾“å…¥å€¼å’Œè¾“å‡ºå€¼ç®¡ç†
- è¡Œæ•°æ®éªŒè¯
- åŒ¹é…ç®—æ³•å®ç°
- å¤åˆ¶å’Œå…‹éš†åŠŸèƒ½

âœ… **ParameterProperty** - å‚æ•°ç‰¹æ€§æ¨¡å‹
- å¤šç§å‚æ•°ç±»å‹æ”¯æŒ
- å€¼éªŒè¯å’Œæ ¼å¼åŒ–
- è‡ªå®šä¹‰å±æ€§å’ŒéªŒè¯è§„åˆ™
- æ•°æ®ç»‘å®šæ”¯æŒ
- å®Œæ•´çš„å±æ€§ç®¡ç†

è¿™äº›æ¨¡å‹ç±»æä¾›äº†å®Œæ•´çš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥ç›´æ¥ç”¨äºUIç»‘å®šå’Œæ•°æ®æŒä¹…åŒ–ã€‚

ğŸ‰ ç°åœ¨æ‚¨æ‹¥æœ‰äº†å®Œæ•´çš„æ•°æ®æ¨¡å‹å®ç°ï¼