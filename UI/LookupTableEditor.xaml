<UserControl x:Class="ZWDynLookup.UI.LookupTableEditor"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:ZWDynLookup.UI"
             Background="White">
    
    <UserControl.Resources>
        <Style x:Key="HeaderStyle" TargetType="TextBlock">
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Margin" Value="0,0,0,5"/>
        </Style>
        
        <Style x:Key="LabelStyle" TargetType="Label">
            <Setter Property="Margin" Value="0,2,5,2"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Width" Value="60"/>
        </Style>
        
        <Style x:Key="TextBoxStyle" TargetType="TextBox">
            <Setter Property="Margin" Value="0,2"/>
            <Setter Property="Padding" Value="3"/>
            <Setter Property="Height" Value="22"/>
        </Style>
        
        <Style x:Key="ButtonStyle" TargetType="Button">
            <Setter Property="Padding" Value="8,2"/>
            <Setter Property="Margin" Value="2"/>
            <Setter Property="MinWidth" Value="60"/>
            <Setter Property="Height" Value="24"/>
        </Style>
        
        <!-- 数据网格样式 -->
        <Style x:Key="DataGridStyle" TargetType="DataGrid">
            <Setter Property="GridLinesVisibility" Value="All"/>
            <Setter Property="AlternatingRowBackground" Value="#FFF5F5F5"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
            <Setter Property="CanUserAddRows" Value="True"/>
            <Setter Property="CanUserDeleteRows" Value="True"/>
            <Setter Property="AutoGenerateColumns" Value="False"/>
            <Setter Property="SelectionMode" Value="Single"/>
            <Setter Property="SelectionUnit" Value="Cell"/>
        </Style>
        
        <!-- 组合框样式 -->
        <Style x:Key="ComboBoxStyle" TargetType="ComboBox">
            <Setter Property="Margin" Value="0,2"/>
            <Setter Property="Padding" Value="3"/>
            <Setter Property="Height" Value="22"/>
        </Style>
    </UserControl.Resources>
    
    <Grid Margin="5">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- 标题栏 -->
        <Border Grid.Row="0" Background="#FFE6E6E6" Padding="10,5" CornerRadius="3">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="查寻表编辑器" Style="{StaticResource HeaderStyle}"/>
                <TextBlock Name="txtTableName" Margin="10,0,0,0" FontWeight="Bold" 
                          Foreground="#FF0066CC"/>
            </StackPanel>
        </Border>
        
        <!-- 工具栏 -->
        <ToolBar Grid.Row="1" Margin="0,5,0,5">
            <Button Name="btnAddRow" Content="添加行" Style="{StaticResource ButtonStyle}" Click="BtnAddRow_Click"/>
            <Button Name="btnDeleteRow" Content="删除行" Style="{StaticResource ButtonStyle}" Click="BtnDeleteRow_Click"/>
            <Button Name="btnClearAll" Content="清空所有" Style="{StaticResource ButtonStyle}" Click="BtnClearAll_Click"/>
            <Separator/>
            <Button Name="btnImportData" Content="导入数据" Style="{StaticResource ButtonStyle}" Click="BtnImportData_Click"/>
            <Button Name="btnExportData" Content="导出数据" Style="{StaticResource ButtonStyle}" Click="BtnExportData_Click"/>
            <Separator/>
            <Button Name="btnValidate" Content="验证数据" Style="{StaticResource ButtonStyle}" Click="BtnValidate_Click"/>
            <Button Name="btnOptimize" Content="优化查寻" Style="{StaticResource ButtonStyle}" Click="BtnOptimize_Click"/>
        </ToolBar>
        
        <!-- 主要数据编辑区域 -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <!-- 左侧：查寻表数据 -->
            <GroupBox Grid.Column="0" Header="查寻表数据">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- 过滤器 -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,5">
                        <Label Content="过滤:" Style="{StaticResource LabelStyle}"/>
                        <TextBox Name="txtFilter" Width="150" Style="{StaticResource TextBoxStyle}" 
                                TextChanged="TxtFilter_TextChanged"/>
                        <Button Name="btnClearFilter" Content="清除" Width="50" Style="{StaticResource ButtonStyle}" 
                               Click="BtnClearFilter_Click"/>
                    </StackPanel>
                    
                    <!-- 数据网格 -->
                    <DataGrid Name="dgLookupTable" Grid.Row="1" Style="{StaticResource DataGridStyle}"
                              LoadingRow="DgLookupTable_LoadingRow"
                              CellEditEnding="DgLookupTable_CellEditEnding"
                              SelectionChanged="DgLookupTable_SelectionChanged">
                    </DataGrid>
                </Grid>
            </GroupBox>
            
            <GridSplitter Grid.Column="1" HorizontalAlignment="Stretch"/>
            
            <!-- 右侧：查寻规则和预览 -->
            <Grid Grid.Column="2">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- 查寻规则配置 -->
                <GroupBox Grid.Row="0" Header="查寻规则">
                    <StackPanel Margin="5">
                        <StackPanel Orientation="Horizontal" Margin="0,2">
                            <Label Content="匹配方式:" Style="{StaticResource LabelStyle}"/>
                            <ComboBox Name="cmbMatchType" Width="120" Style="{StaticResource ComboBoxStyle}">
                                <ComboBoxItem Content="精确匹配" Tag="Exact"/>
                                <ComboBoxItem Content="模糊匹配" Tag="Fuzzy"/>
                                <ComboBoxItem Content="范围匹配" Tag="Range"/>
                                <ComboBoxItem Content="正则匹配" Tag="Regex"/>
                            </ComboBox>
                        </StackPanel>
                        
                        <StackPanel Orientation="Horizontal" Margin="0,2">
                            <Label Content="默认值:" Style="{StaticResource LabelStyle}"/>
                            <TextBox Name="txtDefaultResult" Width="120" Style="{StaticResource TextBoxStyle}"/>
                        </StackPanel>
                        
                        <StackPanel Orientation="Horizontal" Margin="0,2">
                            <Label Content="优先级:" Style="{StaticResource LabelStyle}"/>
                            <ComboBox Name="cmbPriority" Width="120" Style="{StaticResource ComboBoxStyle}">
                                <ComboBoxItem Content="1" Tag="1"/>
                                <ComboBoxItem Content="2" Tag="2"/>
                                <ComboBoxItem Content="3" Tag="3"/>
                                <ComboBoxItem Content="4" Tag="4"/>
                                <ComboBoxItem Content="5" Tag="5"/>
                            </ComboBox>
                        </StackPanel>
                    </StackPanel>
                </GroupBox>
                
                <!-- 查寻结果预览 -->
                <GroupBox Grid.Row="1" Header="查寻预览">
                    <Grid Margin="5">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,5">
                            <Label Content="测试输入:" Style="{StaticResource LabelStyle}"/>
                            <TextBox Name="txtTestInput" Width="100" Style="{StaticResource TextBoxStyle}" 
                                    TextChanged="TxtTestInput_TextChanged"/>
                            <Button Name="btnTestLookup" Content="测试" Width="40" Style="{StaticResource ButtonStyle}" 
                                   Click="BtnTestLookup_Click"/>
                        </StackPanel>
                        
                        <TextBox Name="txtTestResult" Grid.Row="1" IsReadOnly="True" 
                                Background="#FFF9F9F9" AcceptsReturn="True" TextWrapping="Wrap"
                                VerticalScrollBarVisibility="Auto"/>
                    </Grid>
                </GroupBox>
                
                <!-- 数据统计 -->
                <GroupBox Grid.Row="2" Header="数据统计">
                    <StackPanel Margin="5">
                        <StackPanel Orientation="Horizontal" Margin="0,2">
                            <Label Content="总行数:" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Name="txtTotalRows" Text="0" VerticalAlignment="Center"/>
                        </StackPanel>
                        
                        <StackPanel Orientation="Horizontal" Margin="0,2">
                            <Label Content="有效行数:" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Name="txtValidRows" Text="0" VerticalAlignment="Center"/>
                        </StackPanel>
                        
                        <StackPanel Orientation="Horizontal" Margin="0,2">
                            <Label Content="重复行数:" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Name="txtDuplicateRows" Text="0" VerticalAlignment="Center"/>
                        </StackPanel>
                    </StackPanel>
                </GroupBox>
                
                <!-- 错误信息 -->
                <GroupBox Grid.Row="3" Header="错误信息">
                    <TextBox Name="txtErrorInfo" IsReadOnly="True" 
                            Background="#FFFFEEEE" Foreground="#FFDD0000"
                            AcceptsReturn="True" TextWrapping="Wrap"
                            VerticalScrollBarVisibility="Auto" Margin="5"/>
                </GroupBox>
            </Grid>
        </Grid>
        
        <!-- 状态栏 -->
        <Border Grid.Row="3" Background="#FFF0F0F0" Padding="10,2" Margin="0,5,0,0">
            <StatusBar>
                <StatusBarItem>
                    <TextBlock Name="txtStatus" Text="就绪"/>
                </StatusBarItem>
                <StatusBarItem HorizontalAlignment="Right">
                    <TextBlock Name="txtPosition" Text=""/>
                </StatusBarItem>
            </StatusBar>
        </Border>
        
        <!-- 快捷键提示 -->
        <Border Grid.Row="4" Background="#FFF9F9F9" Padding="10,5" CornerRadius="3">
            <TextBlock FontSize="10" Foreground="Gray" TextWrapping="Wrap">
                快捷键: Ctrl+N(新增行) | Ctrl+D(删除行) | Ctrl+S(保存) | F5(刷新) | Ctrl+F(查找)
            </TextBlock>
        </Border>
    </Grid>
</UserControl>