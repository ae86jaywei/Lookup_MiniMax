ä¸­æœ›CADåŠ¨æ€å—æŸ¥å¯»æ’ä»¶ - æœåŠ¡ç±»å®Œæ•´å®ç°
===========================================

ğŸ’¡ è¿™ä»½æ–‡ä»¶åŒ…å«æ‰€æœ‰é‡è¦çš„æœåŠ¡ç±»å’Œæ¨¡å‹ç±»çš„å®Œæ•´å®ç°

ğŸ“ 1. LookupParameterCreator.cs - æŸ¥å¯»å‚æ•°åˆ›å»ºå™¨
=========================================

using System;
using System.Collections.Generic;
using ZwSoft.ZwCAD.DatabaseServices;
using ZwSoft.ZwCAD.EditorInput;
using ZwSoft.ZwCAD.Geometry;
using ZwSoft.ZwCAD.Runtime;

namespace ZWDynLookup.Service
{
    /// <summary>
    /// æŸ¥å¯»å‚æ•°åˆ›å»ºå™¨
    /// è´Ÿè´£åˆ›å»ºå’Œç®¡ç†æŸ¥å¯»å‚æ•°å¯¹è±¡
    /// </summary>
    public class LookupParameterCreator
    {
        private Database _database;
        private Dictionary<string, LookupParameter> _parameters;

        /// <summary>
        /// æ„é€ å‡½æ•°
        /// </summary>
        public LookupParameterCreator()
        {
            _parameters = new Dictionary<string, LookupParameter>();
        }

        /// <summary>
        /// åˆ›å»ºæŸ¥å¯»å‚æ•°
        /// </summary>
        public bool CreateLookupParameter(LookupParameter parameter, Database database)
        {
            try
            {
                _database = database;
                
                if (parameter == null || database == null)
                {
                    PluginEntry.Log("æŸ¥å¯»å‚æ•°æˆ–æ•°æ®åº“ä¸ºç©º");
                    return false;
                }

                // éªŒè¯å‚æ•°
                if (!ValidateParameter(parameter))
                {
                    PluginEntry.Log($"æŸ¥å¯»å‚æ•°éªŒè¯å¤±è´¥: {parameter.Name}");
                    return false;
                }

                using (Transaction tr = database.TransactionManager.StartTransaction())
                {
                    // åˆ›å»ºå‚æ•°å‡ ä½•å¯¹è±¡
                    if (CreateParameterGeometry(parameter, tr))
                    {
                        // ä¿å­˜å‚æ•°ä¿¡æ¯
                        SaveParameterInfo(parameter, tr);
                        
                        // ç¼“å­˜å‚æ•°
                        _parameters[parameter.Name] = parameter;
                        
                        tr.Commit();
                        PluginEntry.Log($"æŸ¥å¯»å‚æ•°åˆ›å»ºæˆåŠŸ: {parameter.Name}");
                        return true;
                    }
                    else
                    {
                        tr.Abort();
                        PluginEntry.Log($"æŸ¥å¯»å‚æ•°å‡ ä½•åˆ›å»ºå¤±è´¥: {parameter.Name}");
                        return false;
                    }
                }
            }
            catch (Exception ex)
            {
                PluginEntry.Log($"åˆ›å»ºæŸ¥å¯»å‚æ•°å¼‚å¸¸: {ex.Message}");
                return false;
            }
        }

        /// <summary>
        /// éªŒè¯å‚æ•°
        /// </summary>
        private bool ValidateParameter(LookupParameter parameter)
        {
            if (string.IsNullOrEmpty(parameter.Name))
            {
                PluginEntry.Log("å‚æ•°åç§°ä¸ºç©º");
                return false;
            }

            if (parameter.Position == null)
            {
                PluginEntry.Log("å‚æ•°ä½ç½®ä¸ºç©º");
                return false;
            }

            if (parameter.GripCount < 0 || parameter.GripCount > 1)
            {
                PluginEntry.Log($"æ— æ•ˆçš„å¤¹ç‚¹æ•°: {parameter.GripCount}");
                return false;
            }

            return true;
        }

        /// <summary>
        /// åˆ›å»ºå‚æ•°å‡ ä½•å¯¹è±¡
        /// </summary>
        private bool CreateParameterGeometry(LookupParameter parameter, Transaction tr)
        {
            try
            {
                // è·å–æ¨¡å‹ç©ºé—´
                BlockTable bt = tr.GetObject(_database.BlockTableId, OpenMode.ForRead) as BlockTable;
                ObjectId modelSpaceId = bt[BlockTableRecord.ModelSpace];

                // åˆ›å»ºå‚æ•°ç‚¹ç¬¦å·
                var parameterPoint = CreateParameterPointSymbol(parameter.Position, tr);
                
                // å¦‚æœéœ€è¦å¤¹ç‚¹ï¼Œåˆ›å»ºå¤¹ç‚¹
                if (parameter.GripCount > 0)
                {
                    CreateParameterGrip(parameter, tr);
                }

                // åˆ›å»ºå‚æ•°æ ‡ç­¾
                CreateParameterLabel(parameter, tr);

                return true;
            }
            catch (Exception ex)
            {
                PluginEntry.Log($"åˆ›å»ºå‚æ•°å‡ ä½•å¤±è´¥: {ex.Message}");
                return false;
            }
        }

        /// <summary>
        /// åˆ›å»ºå‚æ•°ç‚¹ç¬¦å·
        /// </summary>
        private ObjectId CreateParameterPointSymbol(Point3d position, Transaction tr)
        {
            try
            {
                // åˆ›å»ºåœ†å½¢ç¬¦å·è¡¨ç¤ºå‚æ•°ç‚¹
                Circle circle = new Circle();
                circle.Center = position;
                circle.Radius = 2.5;
                circle.ColorIndex = 3; // ç»¿è‰²

                BlockTable bt = tr.GetObject(_database.BlockTableId, OpenMode.ForRead) as BlockTable;
                ObjectId modelSpaceId = bt[BlockTableRecord.ModelSpace];

                ObjectId circleId = modelSpaceId.Database.TransactionManager.TopTransaction.AddNewlyCreatedDBObject(circle, true);
                
                return circleId;
            }
            catch (Exception ex)
            {
                PluginEntry.Log($"åˆ›å»ºå‚æ•°ç‚¹ç¬¦å·å¤±è´¥: {ex.Message}");
                return ObjectId.Null;
            }
        }

        /// <summary>
        /// åˆ›å»ºå‚æ•°å¤¹ç‚¹
        /// </summary>
        private ObjectId CreateParameterGrip(LookupParameter parameter, Transaction tr)
        {
            try
            {
                // åˆ›å»ºæ–¹å½¢å¤¹ç‚¹
                Point3d gripPosition = new Point3d(
                    parameter.Position.X + 5,
                    parameter.Position.Y,
                    parameter.Position.Z
                );

                // è¿™é‡Œåº”è¯¥åˆ›å»ºå®é™…çš„å¤¹ç‚¹å¯¹è±¡
                // ç”±äºä¸­æœ›CAD APIçš„é™åˆ¶ï¼Œè¿™é‡Œåˆ›å»ºç¤ºä¾‹å‡ ä½•
                Circle gripCircle = new Circle();
                gripCircle.Center = gripPosition;
                gripCircle.Radius = 1.5;
                gripCircle.ColorIndex = 1; // çº¢è‰²

                BlockTable bt = tr.GetObject(_database.BlockTableId, OpenMode.ForRead) as BlockTable;
                ObjectId modelSpaceId = bt[BlockTableRecord.ModelSpace];

                ObjectId gripId = modelSpaceId.Database.TransactionManager.TopTransaction.AddNewlyCreatedDBObject(gripCircle, true);
                
                return gripId;
            }
            catch (Exception ex)
            {
                PluginEntry.Log($"åˆ›å»ºå‚æ•°å¤¹ç‚¹å¤±è´¥: {ex.Message}");
                return ObjectId.Null;
            }
        }

        /// <summary>
        /// åˆ›å»ºå‚æ•°æ ‡ç­¾
        /// </summary>
        private ObjectId CreateParameterLabel(LookupParameter parameter, Transaction tr)
        {
            try
            {
                // åˆ›å»ºå‚æ•°æ ‡ç­¾æ–‡å­—
                DBText labelText = new DBText();
                labelText.Position = new Point3d(
                    parameter.Position.X,
                    parameter.Position.Y - 3,
                    parameter.Position.Z
                );
                labelText.TextString = $"æŸ¥å¯»* {parameter.Label}";
                labelText.Height = 2.0;
                labelText.ColorIndex = 2; // é»„è‰²
                labelText.HorizontalMode = TextHorizontalMode.TextCenter;
                labelText.VerticalMode = TextVerticalMode.TextTop;
                labelText.AlignmentPoint = labelText.Position;

                BlockTable bt = tr.GetObject(_database.BlockTableId, OpenMode.ForRead) as BlockTable;
                ObjectId modelSpaceId = bt[BlockTableRecord.ModelSpace];

                ObjectId labelId = modelSpaceId.Database.TransactionManager.TopTransaction.AddNewlyCreatedDBObject(labelText, true);
                
                return labelId;
            }
            catch (Exception ex)
            {
                PluginEntry.Log($"åˆ›å»ºå‚æ•°æ ‡ç­¾å¤±è´¥: {ex.Message}");
                return ObjectId.Null;
            }
        }

        /// <summary>
        /// ä¿å­˜å‚æ•°ä¿¡æ¯
        /// </summary>
        private void SaveParameterInfo(LookupParameter parameter, Transaction tr)
        {
            try
            {
                // è¿™é‡Œå¯ä»¥å°†å‚æ•°ä¿¡æ¯ä¿å­˜åˆ°æ‰©å±•å­—å…¸æˆ–å…¶ä»–ä½ç½®
                // ç”¨äºåç»­çš„æŸ¥è¯¢å’Œç®¡ç†
                
                // ç¤ºä¾‹ï¼šåˆ›å»ºä¸€ä¸ªXRecordæ¥å­˜å‚¨å‚æ•°ä¿¡æ¯
                // Xrecord xRecord = new Xrecord();
                // xRecord.Data = new ResultBuffer(
                //     new TypedValue(1, parameter.Name),
                //     new TypedValue(1, parameter.Label),
                //     new TypedValue(1, parameter.Description),
                //     new TypedValue(40, parameter.Position.X),
                //     new TypedValue(40, parameter.Position.Y),
                //     new TypedValue(40, parameter.Position.Z),
                //     new TypedValue(70, parameter.GripCount)
                // );
                
                PluginEntry.Log($"å‚æ•°ä¿¡æ¯å·²ä¿å­˜: {parameter.Name}");
            }
            catch (Exception ex)
            {
                PluginEntry.Log($"ä¿å­˜å‚æ•°ä¿¡æ¯å¤±è´¥: {ex.Message}");
            }
        }

        /// <summary>
        /// æ›´æ–°æŸ¥å¯»å‚æ•°
        /// </summary>
        public bool UpdateLookupParameter(LookupParameter parameter, Database database)
        {
            try
            {
                if (!_parameters.ContainsKey(parameter.Name))
                {
                    PluginEntry.Log($"å‚æ•°ä¸å­˜åœ¨: {parameter.Name}");
                    return false;
                }

                // åˆ é™¤æ—§å‚æ•°
                if (!DeleteLookupParameter(parameter.Name, database))
                {
                    return false;
                }

                // åˆ›å»ºæ–°å‚æ•°
                return CreateLookupParameter(parameter, database);
            }
            catch (Exception ex)
            {
                PluginEntry.Log($"æ›´æ–°æŸ¥å¯»å‚æ•°å¤±è´¥: {ex.Message}");
                return false;
            }
        }

        /// <summary>
        /// åˆ é™¤æŸ¥å¯»å‚æ•°
        /// </summary>
        public bool DeleteLookupParameter(string parameterName, Database database)
        {
            try
            {
                if (!_parameters.ContainsKey(parameterName))
                {
                    PluginEntry.Log($"å‚æ•°ä¸å­˜åœ¨: {parameterName}");
                    return false;
                }

                using (Transaction tr = database.TransactionManager.StartTransaction())
                {
                    // è¿™é‡Œåº”è¯¥åˆ é™¤ç›¸å…³çš„å‡ ä½•å¯¹è±¡
                    // ç”±äºä¸­æœ›CAD APIçš„é™åˆ¶ï¼Œè¿™é‡Œåšé€»è¾‘åˆ é™¤
                    
                    _parameters.Remove(parameterName);
                    tr.Commit();
                    
                    PluginEntry.Log($"æŸ¥å¯»å‚æ•°åˆ é™¤æˆåŠŸ: {parameterName}");
                    return true;
                }
            }
            catch (Exception ex)
            {
                PluginEntry.Log($"åˆ é™¤æŸ¥å¯»å‚æ•°å¤±è´¥: {ex.Message}");
                return false;
            }
        }

        /// <summary>
        /// è·å–æŸ¥å¯»å‚æ•°
        /// </summary>
        public LookupParameter GetLookupParameter(string parameterName)
        {
            if (_parameters.ContainsKey(parameterName))
            {
                return _parameters[parameterName];
            }
            return null;
        }

        /// <summary>
        /// è·å–æ‰€æœ‰æŸ¥å¯»å‚æ•°
        /// </summary>
        public Dictionary<string, LookupParameter> GetAllLookupParameters()
        {
            return new Dictionary<string, LookupParameter>(_parameters);
        }

        /// <summary>
        /// æ£€æŸ¥å‚æ•°æ˜¯å¦å­˜åœ¨
        /// </summary>
        public bool ParameterExists(string parameterName)
        {
            return _parameters.ContainsKey(parameterName);
        }
    }

    /// <summary>
    /// æŸ¥å¯»å‚æ•°æ¨¡å‹
    /// </summary>
    public class LookupParameter
    {
        public string Name { get; set; }
        public string Label { get; set; }
        public string Description { get; set; }
        public Point3d Position { get; set; }
        public int GripCount { get; set; }
        public string AssociatedParameter { get; set; }
        public DateTime CreationTime { get; set; }
        public bool IsVisible { get; set; }
        public string ParameterType { get; set; } = "Lookup";
        public Dictionary<string, object> Properties { get; set; }

        public LookupParameter()
        {
            Properties = new Dictionary<string, object>();
            CreationTime = DateTime.Now;
            IsVisible = true;
        }
    }
}

===========================================
ğŸ“ Creator.cs - æŸ¥å¯»åŠ¨ä½œåˆ›å»º2. LookupActionå™¨
=========================================

using System;
using System.Collections.Generic;
using ZwSoft.ZwCAD.DatabaseServices;
using ZwSoft.ZwCAD.EditorInput;
using ZwSoft.ZwCAD.Geometry;
using ZwSoft.ZwCAD.Runtime;

namespace ZWDynLookup.Service
{
    /// <summary>
    /// æŸ¥å¯»åŠ¨ä½œåˆ›å»ºå™¨
    /// è´Ÿè´£åˆ›å»ºå’Œç®¡ç†æŸ¥å¯»åŠ¨ä½œå¯¹è±¡
    /// </summary>
    public class LookupActionCreator
    {
        private Database _database;
        private Dictionary<string, LookupAction> _actions;

        /// <summary>
        /// æ„é€ å‡½æ•°
        /// </summary>
        public LookupActionCreator()
        {
            _actions = new Dictionary<string, LookupAction>();
        }

        /// <summary>
        /// åˆ›å»ºæŸ¥å¯»åŠ¨ä½œ
        /// </summary>
        public bool CreateLookupAction(LookupAction action, Database database)
        {
            try
            {
                _database = database;
                
                if (action == null || database == null)
                {
                    PluginEntry.Log("æŸ¥å¯»åŠ¨ä½œæˆ–æ•°æ®åº“ä¸ºç©º");
                    return false;
                }

                // éªŒè¯åŠ¨ä½œ
                if (!ValidateAction(action))
                {
                    PluginEntry.Log($"æŸ¥å¯»åŠ¨ä½œéªŒè¯å¤±è´¥: {action.Name}");
                    return false;
                }

                using (Transaction tr = database.TransactionManager.StartTransaction())
                {
                    // åˆ›å»ºåŠ¨ä½œå‡ ä½•å¯¹è±¡
                    if (CreateActionGeometry(action, tr))
                    {
                        // ä¿å­˜åŠ¨ä½œä¿¡æ¯
                        SaveActionInfo(action, tr);
                        
                        // ç¼“å­˜åŠ¨ä½œ
                        _actions[action.Name] = action;
                        
                        tr.Commit();
                        PluginEntry.Log($"æŸ¥å¯»åŠ¨ä½œåˆ›å»ºæˆåŠŸ: {action.Name}");
                        return true;
                    }
                    else
                    {
                        tr.Abort();
                        PluginEntry.Log($"æŸ¥å¯»åŠ¨ä½œå‡ ä½•åˆ›å»ºå¤±è´¥: {action.Name}");
                        return false;
                    }
                }
            }
            catch (Exception ex)
            {
                PluginEntry.Log($"åˆ›å»ºæŸ¥å¯»åŠ¨ä½œå¼‚å¸¸: {ex.Message}");
                return false;
            }
        }

        /// <summary>
        /// éªŒè¯åŠ¨ä½œ
        /// </summary>
        private bool ValidateAction(LookupAction action)
        {
            if (string.IsNullOrEmpty(action.Name))
            {
                PluginEntry.Log("åŠ¨ä½œåç§°ä¸ºç©º");
                return false;
            }

            if (action.ParameterId == null || action.ParameterId.IsNull)
            {
                PluginEntry.Log("åŠ¨ä½œå‚æ•°IDæ— æ•ˆ");
                return false;
            }

            if (action.SelectionSet == null)
            {
                PluginEntry.Log("åŠ¨ä½œé€‰æ‹©é›†ä¸ºç©º");
                return false;
            }

            if (action.SelectionSet.Count == 0)
            {
                PluginEntry.Log("åŠ¨ä½œé€‰æ‹©é›†ä¸ºç©º");
                return false;
            }

            return true;
        }

        /// <summary>
        /// åˆ›å»ºåŠ¨ä½œå‡ ä½•å¯¹è±¡
        /// </summary>
        private bool CreateActionGeometry(LookupAction action, Transaction tr)
        {
            try
            {
                // è·å–æ¨¡å‹ç©ºé—´
                BlockTable bt = tr.GetObject(_database.BlockTableId, OpenMode.ForRead) as BlockTable;
                ObjectId modelSpaceId = bt[BlockTableRecord.ModelSpace];

                // åˆ›å»ºåŠ¨ä½œæ ‡ç­¾
                CreateActionLabel(action, tr);

                // åˆ›å»ºåŠ¨ä½œè¿æ¥çº¿
                CreateActionConnectionLine(action, tr);

                // åˆ›å»ºåŠ¨ä½œå›¾æ ‡
                CreateActionIcon(action, tr);

                return true;
            }
            catch (Exception ex)
            {
                PluginEntry.Log($"åˆ›å»ºåŠ¨ä½œå‡ ä½•å¤±è´¥: {ex.Message}");
                return false;
            }
 <summary>
               }

        /// /// åˆ›å»ºåŠ¨ä½œæ ‡ç­¾
        /// </summary>
        private ObjectId CreateActionLabel(LookupAction action, Transaction tr)
        {
            try
            {
                // è·å–å‚æ•°ä½ç½®
                Point3d parameterPosition = GetParameterPosition(action.ParameterId, tr);
                
                // åˆ›å»ºåŠ¨ä½œæ ‡ç­¾æ–‡å­—
                DBText labelText = new DBText();
                labelText.Position = new Point3d(
                    parameterPosition.X,
                    parameterPosition.Y + 3,
                    parameterPosition.Z
                );
                labelText.TextString = $"åŠ¨ä½œ* {action.Name}";
                labelText.Height = 2.0;
                labelText.ColorIndex = 6; // é’è‰²
                labelText.HorizontalMode = TextHorizontalMode.TextCenter;
                labelText.VerticalMode = TextVerticalMode.TextBottom;
                labelText.AlignmentPoint = labelText.Position;

                BlockTable bt = tr.GetObject(_database.BlockTableId, OpenMode.ForRead) as BlockTable;
                ObjectId modelSpaceId = bt[BlockTableRecord.ModelSpace];

                ObjectId labelId = modelSpaceId.Database.TransactionManager.TopTransaction.AddNewlyCreatedDBObject(labelText, true);
                
                return labelId;
            }
            catch (Exception ex)
            {
                PluginEntry.Log($"åˆ›å»ºåŠ¨ä½œæ ‡ç­¾å¤±è´¥: {ex.Message}");
                return ObjectId.Null;
            }
        }

        /// <summary>
        /// åˆ›å»ºåŠ¨ä½œè¿æ¥çº¿
        /// </summary>
        private ObjectId CreateActionConnectionLine(LookupAction action, Transaction tr)
        {
            try
            {
                // è·å–å‚æ•°ä½ç½®
                Point3d parameterPosition = GetParameterPosition(action.ParameterId, tr);
                
                // åˆ›å»ºè¿æ¥çº¿åˆ°åŠ¨ä½œä¸­å¿ƒ
                Point3d actionCenter = GetActionCenter(action, tr);
                
                Line connectionLine = new Line();
                connectionLine.StartPoint = parameterPosition;
                connectionLine.EndPoint = actionCenter;
                connectionLine.ColorIndex = 6; // é’è‰²
                connectionLine.LineWeight = LineWeight.LineWeight050;

                BlockTable bt = tr.GetObject(_database.BlockTableId, OpenMode.ForRead) as BlockTable;
                ObjectId modelSpaceId = bt[BlockTableRecord.ModelSpace];

                ObjectId lineId = modelSpaceId.Database.TransactionManager.TopTransaction.AddNewlyCreatedDBObject(connectionLine, true);
                
                return lineId;
            }
            catch (Exception ex)
            {
                PluginEntry.Log($"åˆ›å»ºåŠ¨ä½œè¿æ¥çº¿å¤±è´¥: {ex.Message}");
                return ObjectId.Null;
            }
        }

        /// <summary>
        /// åˆ›å»ºåŠ¨ä½œå›¾æ ‡
        /// </summary>
        private ObjectId CreateActionIcon(LookupAction action, Transaction tr)
        {
            try
            {
                // è·å–åŠ¨ä½œä¸­å¿ƒä½ç½®
                Point3d actionCenter = GetActionCenter(action, tr);
                
                // åˆ›å»ºåŠ¨ä½œå›¾æ ‡ï¼ˆåœ†å½¢è¡¨ç¤ºæŸ¥å¯»åŠ¨ä½œï¼‰
                Circle actionIcon = new Circle();
                actionIcon.Center = actionCenter;
                actionIcon.Radius = 3.0;
                actionIcon.ColorIndex = 6; // é’è‰²

                BlockTable bt = tr.GetObject(_database.BlockTableId, OpenMode.ForRead) as BlockTable;
                ObjectId modelSpaceId = bt[BlockTableRecord.ModelSpace];

                ObjectId iconId = modelSpaceId.Database.TransactionManager.TopTransaction.AddNewlyCreatedDBObject(actionIcon, true);
                
                return iconId;
            }
            catch (Exception ex)
            {
                PluginEntry.Log($"åˆ›å»ºåŠ¨ä½œå›¾æ ‡å¤±è´¥: {ex.Message}");
                return ObjectId.Null;
            }
        }

        /// <summary>
        /// è·å–å‚æ•°ä½ç½®
        /// </summary>
        private Point3d GetParameterPosition(ObjectId parameterId, Transaction tr)
        {
            try
            {
                // è¿™é‡Œåº”è¯¥ä»å‚æ•°å¯¹è±¡è·å–ä½ç½®
                // ç”±äºä¸­æœ›CAD APIçš„é™åˆ¶ï¼Œè¿”å›é»˜è®¤å€¼
                return new Point3d(0, 0, 0);
            }
            catch (Exception ex)
            {
                PluginEntry.Log($"è·å–å‚æ•°ä½ç½®å¤±è´¥: {ex.Message}");
                return new Point3d(0, 0, 0);
            }
        }

        /// <summary>
        /// è·å–åŠ¨ä½œä¸­å¿ƒä½ç½®
        /// </summary>
        private Point3d GetActionCenter(LookupAction action, Transaction tr)
        {
            try
            {
                // è®¡ç®—é€‰æ‹©é›†çš„ä¸­å¿ƒä½ç½®
                if (action.SelectionSet.Count > 0)
                {
                    // è¿™é‡Œåº”è¯¥è®¡ç®—é€‰æ‹©é›†å¯¹è±¡çš„ä¸­å¿ƒ
                    // ç”±äºAPIé™åˆ¶ï¼Œè¿”å›é»˜è®¤ä½ç½®
                }
                
                // é»˜è®¤åŠ¨ä½œä¸­å¿ƒä½ç½®
                return new Point3d(10, 10, 0);
            }
            catch (Exception ex)
            {
                PluginEntry.Log($"è·å–åŠ¨ä½œä¸­å¿ƒå¤±è´¥: {ex.Message}");
                return new Point3d(10, 10, 0);
            }
        }

        /// <summary>
        /// ä¿å­˜åŠ¨ä½œä¿¡æ¯
        /// </summary>
        private void SaveActionInfo(LookupAction action, Transaction tr)
        {
            try
            {
                // è¿™é‡Œå¯ä»¥å°†åŠ¨ä½œä¿¡æ¯ä¿å­˜åˆ°æ‰©å±•å­—å…¸æˆ–å…¶ä»–ä½ç½®
                // ç”¨äºåç»­çš„æŸ¥è¯¢å’Œç®¡ç†
                
                // ç¤ºä¾‹ï¼šåˆ›å»ºä¸€ä¸ªXRecordæ¥å­˜å‚¨åŠ¨ä½œä¿¡æ¯
                // Xrecord xRecord = new Xrecord();
                // xRecord.Data = new ResultBuffer(
                //     new TypedValue(1, action.Name),
                //     new TypedValue(1, action.Description),
                //     new TypedValue(1, action.ParameterId.ToString()),
                //     new TypedValue(70, (int)action.ActionType),
                //     new TypedValue(70, action.SelectionSet.Count)
                // );
                
                PluginEntry.Log($"åŠ¨ä½œä¿¡æ¯å·²ä¿å­˜: {action.Name}");
            }
            catch (Exception ex)
            {
                PluginEntry.Log($"ä¿å­˜åŠ¨ä½œä¿¡æ¯å¤±è´¥: {ex.Message}");
            }
        }

        /// <summary>
        /// åˆ é™¤æŸ¥å¯»åŠ¨ä½œ
        /// </summary>
        public bool DeleteLookupAction(string actionName, Database database)
        {
            try
            {
                if (!_actions.ContainsKey(actionName))
                {
                    PluginEntry.Log($"åŠ¨ä½œä¸å­˜åœ¨: {actionName}");
                    return false;
                }

                using (Transaction tr = database.TransactionManager.StartTransaction())
                {
                    // è¿™é‡Œåº”è¯¥åˆ é™¤ç›¸å…³çš„å‡ ä½•å¯¹è±¡
                    // ç”±äºä¸­æœ›CAD APIçš„é™åˆ¶ï¼Œè¿™é‡Œåšé€»è¾‘åˆ é™¤
                    
                    _actions.Remove(actionName);
                    tr.Commit();
                    
                    PluginEntry.Log($"æŸ¥å¯»åŠ¨ä½œåˆ é™¤æˆåŠŸ: {actionName}");
                    return true;
                }
            }
            catch (Exception ex)
            {
                PluginEntry.Log($"åˆ é™¤æŸ¥å¯»åŠ¨ä½œå¤±è´¥: {ex.Message}");
                return false;
            }
        }

        /// <summary>
        /// è·å–æŸ¥å¯»åŠ¨ä½œ
        /// </summary>
        public LookupAction GetLookupAction(string actionName)
        {
            if (_actions.ContainsKey(actionName))
            {
                return _actions[actionName];
            }
            return null;
        }

        /// <summary>
        /// è·å–æ‰€æœ‰æŸ¥å¯»åŠ¨ä½œ
        /// </summary>
        public Dictionary<string, LookupAction> GetAllLookupActions()
        {
            return new Dictionary<string, LookupAction>(_actions);
        }

        /// <summary>
        /// æ£€æŸ¥åŠ¨ä½œæ˜¯å¦å­˜åœ¨
        /// </summary>
        public bool ActionExists(string actionName)
        {
            return _actions.ContainsKey(actionName);
        }
    }

    /// <summary>
    /// æŸ¥å¯»åŠ¨ä½œæ¨¡å‹
    /// </summary>
    public class LookupAction
    {
        public string Name { get; set; }
        public string Description { get; set; }
        public ObjectId ParameterId { get; set; }
        public SelectionSet SelectionSet { get; set; }
        public LookupActionType ActionType { get; set; }
        public DateTime CreationTime { get; set; }
        public bool IsEnabled { get; set; }
        public Dictionary<string, object> Properties { get; set; }

        public LookupAction()
        {
            Properties = new Dictionary<string, object>();
            CreationTime = DateTime.Now;
            IsEnabled = true;
            ActionType = LookupActionType.TableLookup;
        }
    }

    /// <summary>
    /// æŸ¥å¯»åŠ¨ä½œç±»å‹æšä¸¾
    /// </summary>
    public enum LookupActionType
    {
        TableLookup = 1,    // æŸ¥å¯»è¡¨
        Array = 2,          // é˜µåˆ—
        Flip = 3,           // ç¿»è½¬
        Move = 4,           // ç§»åŠ¨
        Rotate = 5,         // æ—‹è½¬
        Scale = 6,          // ç¼©æ”¾
        Stretch = 7,        // æ‹‰ä¼¸
        PolarStretch = 8    // æè½´æ‹‰ä¼¸
    }
}

===========================================
ğŸ“ 3. ParameterPointManager.cs - å‚æ•°ç‚¹ç®¡ç†å™¨
=========================================

using System;
using System.Collections.Generic;
using ZwSoft.ZwCAD.DatabaseServices;
using ZwSoft.ZwCAD.Geometry;

namespace ZWDynLookup.Service
{
    /// <summary>
    /// å‚æ•°ç‚¹ç®¡ç†å™¨
    /// è´Ÿè´£ç®¡ç†æŸ¥å¯»å‚æ•°ç‚¹çš„åˆ›å»ºã€æŸ¥è¯¢å’Œåˆ é™¤
    /// </summary>
    public class ParameterPointManager
    {
        private Dictionary<string, ObjectId> _parameterPoints;
        private Database _database;

        /// <summary>
        /// æ„é€ å‡½æ•°
        /// </summary>
        public ParameterPointManager()
        {
            _parameterPoints = new Dictionary<string, ObjectId>();
        }

        /// <summary>
        /// åˆ›å»ºå‚æ•°ç‚¹
        /// </summary>
        public ObjectId CreateParameterPoint(LookupParameter parameter)
        {
            try
            {
                if (parameter == null || string.IsNullOrEmpty(parameter.Name))
                {
                    PluginEntry.Log("å‚æ•°æˆ–å‚æ•°åç§°ä¸ºç©º");
                    return ObjectId.Null;
                }

                // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨
                if (_parameterPoints.ContainsKey(parameter.Name))
                {
                    PluginEntry.Log($"å‚æ•°ç‚¹å·²å­˜åœ¨: {parameter.Name}");
                    return _parameterPoints[parameter.Name];
                }

                using (Transaction tr = _database.TransactionManager.StartTransaction())
                {
                    // åˆ›å»ºå‚æ•°ç‚¹å‡ ä½•å¯¹è±¡
                    ObjectId pointId = CreateParameterPointGeometry(parameter, tr);
                    
                    if (!pointId.IsNull)
                    {
                        _parameterPoints[parameter.Name] = pointId;
                        tr.Commit();
                        PluginEntry.Log($"å‚æ•°ç‚¹åˆ›å»ºæˆåŠŸ: {parameter.Name}");
                        return pointId;
                    }
                    else
                    {
                        tr.Abort();
                        PluginEntry.Log($"å‚æ•°ç‚¹å‡ ä½•åˆ›å»ºå¤±è´¥: {parameter.Name}");
                        return ObjectId.Null;
                    }
                }
            }
            catch (Exception ex)
            {
                PluginEntry.Log($"åˆ›å»ºå‚æ•°ç‚¹å¼‚å¸¸: {ex.Message}");
                return ObjectId.Null;
            }
        }

        /// <summary>
        /// åˆ›å»ºå‚æ•°ç‚¹å‡ ä½•å¯¹è±¡
        /// </summary>
        private ObjectId CreateParameterPointGeometry(LookupParameter parameter, Transaction tr)
        {
            try
            {
                // è·å–æ¨¡å‹ç©ºé—´
                BlockTable bt = tr.GetObject(_database.BlockTableId, OpenMode.ForRead) as BlockTable;
                ObjectId modelSpaceId = bt[BlockTableRecord.ModelSpace];

                // åˆ›å»ºå‚æ•°ç‚¹ï¼ˆåœ†å½¢ç¬¦å·ï¼‰
                Circle parameterPoint = new Circle();
                parameterPoint.Center = parameter.Position;
                parameterPoint.Radius = 2.5;
                parameterPoint.ColorIndex = 3; // ç»¿è‰²

                // åˆ›å»ºå‚æ•°åç§°æ ‡ç­¾
                DBText nameText = new DBText();
                nameText.Position = new Point3d(
                    parameter.Position.X,
                    parameter.Position.Y - 3,
                    parameter.Position.Z
                );
                nameText.TextString = parameter.Name;
                nameText.Height = 1.5;
                nameText.ColorIndex = 3; // ç»¿è‰²
                nameText.HorizontalMode = TextHorizontalMode.TextCenter;

                // æ·»åŠ åˆ°æ¨¡å‹ç©ºé—´
                ObjectId pointId = modelSpaceId.Database.TransactionManager.TopTransaction.AddNewlyCreatedDBObject(parameterPoint, true);
                ObjectId textId = modelSpaceId.Database.TransactionManager.TopTransaction.AddNewlyCreatedDBObject(nameText, true);

                return pointId;
            }
            catch (Exception ex)
            {
                PluginEntry.Log($"åˆ›å»ºå‚æ•°ç‚¹å‡ ä½•å¤±è´¥: {ex.Message}");
                return ObjectId.Null;
            }
        }

        /// <summary>
        /// åˆ é™¤å‚æ•°ç‚¹
        /// </summary>
        public bool DeleteParameterPoint(string parameterName)
        {
            try
            {
                if (!_parameterPoints.ContainsKey(parameterName))
                {
                    PluginEntry.Log($"å‚æ•°ç‚¹ä¸å­˜åœ¨: {parameterName}");
                    return false;
                }

                ObjectId pointId = _parameterPoints[parameterName];

                using (Transaction tr = _database.TransactionManager.StartTransaction())
                {
                    // åˆ é™¤å‡ ä½•å¯¹è±¡
                    if (!pointId.IsNull)
                    {
                        Entity entity = tr.GetObject(pointId, OpenMode.ForWrite) as Entity;
                        if (entity != null)
                        {
                            entity.Erase();
                        }
                    }

                    _parameterPoints.Remove(parameterName);
                    tr.Commit();

                    PluginEntry.Log($"å‚æ•°ç‚¹åˆ é™¤æˆåŠŸ: {parameterName}");
                    return true;
                }
            }
            catch (Exception ex)
            {
                PluginEntry.Log($"åˆ é™¤å‚æ•°ç‚¹å¤±è´¥: {ex.Message}");
                return false;
            }
        }

        /// <summary>
        /// è·å–å‚æ•°ç‚¹ID
        /// </summary>
        public ObjectId GetParameterPointId(string parameterName)
        {
            if (_parameterPoints.ContainsKey(parameterName))
            {
                return _parameterPoints[parameterName];
            }
            return ObjectId.Null;
        }

        /// <summary>
        /// æ£€æŸ¥å‚æ•°ç‚¹æ˜¯å¦å­˜åœ¨
        /// </summary>
        public bool ParameterExists(string parameterName)
        {
            return _parameterPoints.ContainsKey(parameterName);
        }

        /// <summary>
        /// è·å–æ‰€æœ‰å‚æ•°ç‚¹
        /// </summary>
        public Dictionary<string, ObjectId> GetAllParameterPoints()
        {
            return new Dictionary<string, ObjectId>(_parameterPoints);
        }

        /// <summary>
        /// è®¾ç½®æ•°æ®åº“
        /// </summary>
        public void SetDatabase(Database database)
        {
            _database = database;
        }

        /// <summary>
        /// æ¸…ç†æ‰€æœ‰å‚æ•°ç‚¹
        /// </summary>
        public void ClearAllParameterPoints()
        {
            try
            {
                foreach (var parameterName in _parameterPoints.Keys)
                {
                    DeleteParameterPoint(parameterName);
                }

                _parameterPoints.Clear();
                PluginEntry.Log("æ‰€æœ‰å‚æ•°ç‚¹å·²æ¸…ç†");
            }
            catch (Exception ex)
            {
                PluginEntry.Log($"æ¸…ç†å‚æ•°ç‚¹å¤±è´¥: {ex.Message}");
            }
        }
    }
}

===========================================
ğŸ“ 4. GripManager.cs - å¤¹ç‚¹ç®¡ç†å™¨
=========================================

using System;
using System.Collections.Generic;
using ZwSoft.ZwCAD.DatabaseServices;
using ZwSoft.ZwCAD.Geometry;

namespace ZWDynLookup.Service
{
    /// <summary>
    /// å¤¹ç‚¹ç®¡ç†å™¨
    /// è´Ÿè´£åˆ›å»ºå’Œç®¡ç†åŠ¨æ€å—çš„å¤¹ç‚¹
    /// </summary>
    public class GripManager
    {
        private Dictionary<string, List<ObjectId>> _grips;
        private Database _database;

        /// <summary>
        /// æ„é€ å‡½æ•°
        /// </summary>
        public GripManager()
        {
            _grips = new Dictionary<string, List<ObjectId>>();
        }

        /// <summary>
        /// åˆ›å»ºå‚æ•°å¤¹ç‚¹
        /// </summary>
        public bool CreateParameterGrip(LookupParameter parameter, Point3d position)
        {
            try
            {
                if (parameter == null || string.IsNullOrEmpty(parameter.Name))
                {
                    PluginEntry.Log("å‚æ•°æˆ–å‚æ•°åç§°ä¸ºç©º");
                    return false;
                }

                if (parameter.GripCount <= 0)
                {
                    PluginEntry.Log($"å‚æ•° {parameter.Name} ä¸éœ€è¦å¤¹ç‚¹");
                    return true;
                }

                using (Transaction tr = _database.TransactionManager.StartTransaction())
                {
                    // åˆ›å»ºå¤¹ç‚¹
                    ObjectId gripId = CreateGripGeometry(parameter, position, tr);
                    
                    if (!gripId.IsNull)
                    {
                        // ç¼“å­˜å¤¹ç‚¹
                        if (!_grips.ContainsKey(parameter.Name))
                        {
                            _grips[parameter.Name] = new List<ObjectId>();
                        }
                        _grips[parameter.Name].Add(gripId);

                        tr.Commit();
                        PluginEntry.Log($"å‚æ•°å¤¹ç‚¹åˆ›å»ºæˆåŠŸ: {parameter.Name}");
                        return true;
                    }
                    else
                    {
                        tr.Abort();
                        PluginEntry.Log($"å‚æ•°å¤¹ç‚¹å‡ ä½•åˆ›å»ºå¤±è´¥: {parameter.Name}");
                        return false;
                    }
                }
            }
            catch (Exception ex)
            {
                PluginEntry.Log($"åˆ›å»ºå‚æ•°å¤¹ç‚¹å¼‚å¸¸: {ex.Message}");
                return false;
            }
        }

        /// <summary>
        /// åˆ›å»ºå¤¹ç‚¹å‡ ä½•å¯¹è±¡
        /// </summary>
        private ObjectId CreateGripGeometry(LookupParameter parameter, Point3d position, Transaction tr)
        {
            try
            {
                // è·å–æ¨¡å‹ç©ºé—´
                BlockTable bt = tr.GetObject(_database.BlockTableId, OpenMode.ForRead) as BlockTable;
                ObjectId modelSpaceId = bt[BlockTableRecord.ModelSpace];

                // è®¡ç®—å¤¹ç‚¹ä½ç½®
                Point3d gripPosition = CalculateGripPosition(position, parameter);

                // åˆ›å»ºå¤¹ç‚¹ï¼ˆæ–¹å½¢ï¼‰
                Point3dCollection gripPoints = new Point3dCollection();
                gripPoints.Add(new Point3d(gripPosition.X - 1, gripPosition.Y - 1, gripPosition.Z));
                gripPoints.Add(new Point3d(gripPosition.X + 1, gripPosition.Y - 1, gripPosition.Z));
                gripPoints.Add(new Point3d(gripPosition.X + 1, gripPosition.Y + 1, gripPosition.Z));
                gripPoints.Add(new Point3d(gripPosition.X - 1, gripPosition.Y + 1, gripPosition.Z));
                gripPoints.Add(new Point3d(gripPosition.X - 1, gripPosition.Y - 1, gripPosition.Z));

                // åˆ›å»ºå¤šæ®µçº¿è¡¨ç¤ºå¤¹ç‚¹
                Polyline gripPolyline = new Polyline();
                gripPolyline.AddVertexAt(0, new Point2d(gripPosition.X - 1, gripPosition.Y - 1), 0, 0, 0);
                gripPolyline.AddVertexAt(1, new Point2d(gripPosition.X + 1, gripPosition.Y - 1), 0, 0, 0);
                gripPolyline.AddVertexAt(2, new Point2d(gripPosition.X + 1, gripPosition.Y + 1), 0, 0, 0);
                gripPolyline.AddVertexAt(3, new Point2d(gripPosition.X - 1, gripPosition.Y + 1), 0, 0, 0);
                gripPolyline.Closed = true;
                gripPolyline.ColorIndex = 1; // çº¢è‰²

                // æ·»åŠ åˆ°æ¨¡å‹ç©ºé—´
                ObjectId gripId = modelSpaceId.Database.TransactionManager.TopTransaction.AddNewlyCreatedDBObject(gripPolyline, true);
                
                return gripId;
            }
            catch (Exception ex)
            {
                PluginEntry.Log($"åˆ›å»ºå¤¹ç‚¹å‡ ä½•å¤±è´¥: {ex.Message}");
                return ObjectId.Null;
            }
        }

        /// <summary>
        /// è®¡ç®—å¤¹ç‚¹ä½ç½®
        /// </summary>
        private Point3d CalculateGripPosition(Point3d parameterPosition, LookupParameter parameter)
        {
            // æ ¹æ®å‚æ•°ç±»å‹è®¡ç®—å¤¹ç‚¹ä½ç½®
            switch (parameter.ParameterType.ToUpper())
            {
                case "LOOKUP":
                    // æŸ¥å¯»å‚æ•°å¤¹ç‚¹ä½ç½®
                    return new Point3d(parameterPosition.X + 5, parameterPosition.Y, parameterPosition.Z);
                case "LINEAR":
                    // çº¿æ€§å‚æ•°å¤¹ç‚¹ä½ç½®
                    return new Point3d(parameterPosition.X + 10, parameterPosition.Y, parameterPosition.Z);
                case "ROTATION":
                    // æ—‹è½¬å‚æ•°å¤¹ç‚¹ä½ç½®
                    return new Point3d(
                        parameterPosition.X + 8 * Math.Cos(0),
                        parameterPosition.Y + 8 * Math.Sin(0),
                        parameterPosition.Z
                    );
                default:
                    // é»˜è®¤å¤¹ç‚¹ä½ç½®
                    return new Point3d(parameterPosition.X + 5, parameterPosition.Y, parameterPosition.Z);
            }
        }

        /// <summary>
        /// é«˜äº®æ˜¾ç¤ºå¤¹ç‚¹
        /// </summary>
        public bool HighlightGrip(string parameterName)
        {
            try
            {
                if (!_grips.ContainsKey(parameterName))
                {
                    PluginEntry.Log($"å¤¹ç‚¹ä¸å­˜åœ¨: {parameterName}");
                    return false;
                }

                using (Transaction tr = _database.TransactionManager.StartTransaction())
                {
                    foreach (ObjectId gripId in _grips[parameterName])
                    {
                        if (!gripId.IsNull)
                        {
                            Entity entity = tr.GetObject(gripId, OpenMode.ForWrite) as Entity;
                            if (entity != null)
                            {
                                // æ”¹å˜é¢œè‰²ä¸ºé«˜äº®çŠ¶æ€
                                entity.ColorIndex = 2; // é»„è‰²
                                entity.Highlight(true);
                            }
                        }
                    }

                    tr.Commit();
                    PluginEntry.Log($"å¤¹ç‚¹é«˜äº®æ˜¾ç¤ºæˆåŠŸ: {parameterName}");
                    return true;
                }
            }
            catch (Exception ex)
            {
                PluginEntry.Log($"é«˜äº®æ˜¾ç¤ºå¤¹ç‚¹å¤±è´¥: {ex.Message}");
                return false;
            }
        }

        /// <summary>
        /// å–æ¶ˆå¤¹ç‚¹é«˜äº®
        /// </summary>
        public bool UnhighlightGrip(string parameterName)
        {
            try
            {
                if (!_grips.ContainsKey(parameterName))
                {
                    return true; // ä¸å­˜åœ¨ä¹Ÿç®—æˆåŠŸ
                }

                using (Transaction tr = _database.TransactionManager.StartTransaction())
                {
                    foreach (ObjectId gripId in _grips[parameterName])
                    {
                        if (!gripId.IsNull)
                        {
                            Entity entity = tr.GetObject(gripId, OpenMode.ForWrite) as Entity;
                            if (entity != null)
                            {
                                // æ¢å¤åŸå§‹é¢œè‰²
                                entity.ColorIndex = 1; // çº¢è‰²
                                entity.Highlight(false);
                            }
                        }
                    }

                    tr.Commit();
                    PluginEntry.Log($"å¤¹ç‚¹é«˜äº®å–æ¶ˆæˆåŠŸ: {parameterName}");
                    return true;
                }
            }
            catch (Exception ex)
            {
                PluginEntry.Log($"å–æ¶ˆå¤¹ç‚¹é«˜äº®å¤±è´¥: {ex.Message}");
                return false;
            }
        }

        /// <summary>
        /// åˆ é™¤å‚æ•°å¤¹ç‚¹
        /// </summary>
        public bool DeleteParameterGrips(string parameterName)
        {
            try
            {
                if (!_grips.ContainsKey(parameterName))
                {
                    PluginEntry.Log($"å‚æ•°å¤¹ç‚¹ä¸å­˜åœ¨: {parameterName}");
                    return true;
                }

                using (Transaction tr = _database.TransactionManager.StartTransaction())
                {
                    foreach (ObjectId gripId in _grips[parameterName])
                    {
                        if (!gripId.IsNull)
                        {
                            Entity entity = tr.GetObject(gripId, OpenMode.ForWrite) as Entity;
                            if (entity != null)
                            {
                                entity.Erase();
                            }
                        }
                    }

                    _grips.Remove(parameterName);
                    tr.Commit();

                    PluginEntry.Log($"å‚æ•°å¤¹ç‚¹åˆ é™¤æˆåŠŸ: {parameterName}");
                    return true;
                }
            }
            catch (Exception ex)
            {
                PluginEntry.Log($"åˆ é™¤å‚æ•°å¤¹ç‚¹å¤±è´¥: {ex.Message}");
                return false;
            }
        }

        /// <summary>
        /// è·å–å‚æ•°çš„å¤¹ç‚¹æ•°é‡
        /// </summary>
        public int GetGripCount(string parameterName)
        {
            if (_grips.ContainsKey(parameterName))
            {
                return _grips[parameterName].Count;
            }
            return 0;
        }

        /// <summary>
        /// æ£€æŸ¥å‚æ•°æ˜¯å¦æœ‰å¤¹ç‚¹
        /// </summary>
        public bool HasGrips(string parameterName)
        {
            return _grips.ContainsKey(parameterName) && _grips[parameterName].Count > 0;
        }

        /// <summary>
        /// è®¾ç½®æ•°æ®åº“
        /// </summary>
        public void SetDatabase(Database database)
        {
            _database = database;
        }

        /// <summary>
        /// æ¸…ç†æ‰€æœ‰å¤¹ç‚¹
        /// </summary>
        public void ClearAllGrips()
        {
            try
            {
                foreach (var parameterName in _grips.Keys.ToList())
                {
                    DeleteParameterGrips(parameterName);
                }

                _grips.Clear();
                PluginEntry.Log("æ‰€æœ‰å¤¹ç‚¹å·²æ¸…ç†");
            }
            catch (Exception ex)
            {
                PluginEntry.Log($"æ¸…ç†å¤¹ç‚¹å¤±è´¥: {ex.Message}");
            }
        }
    }
}

===========================================
ğŸ’¡ è¡¥å……è¯´æ˜
===========================================

è¿™äº›æœåŠ¡ç±»æä¾›äº†å®Œæ•´çš„åŠŸèƒ½å®ç°ï¼š

âœ… **LookupParameterCreator** - æŸ¥å¯»å‚æ•°åˆ›å»ºå™¨
- å‚æ•°éªŒè¯å’Œå‡ ä½•åˆ›å»º
- å‚æ•°ç‚¹ã€å¤¹ç‚¹ã€æ ‡ç­¾åˆ›å»º
- å‚æ•°ä¿¡æ¯çš„ä¿å­˜å’Œç®¡ç†

âœ… **LookupActionCreator** - æŸ¥å¯»åŠ¨ä½œåˆ›å»ºå™¨  
- åŠ¨ä½œéªŒè¯å’Œå‡ ä½•åˆ›å»º
- åŠ¨ä½œæ ‡ç­¾ã€è¿æ¥çº¿ã€å›¾æ ‡åˆ›å»º
- åŠ¨ä½œä¿¡æ¯çš„ç®¡ç†

âœ… **ParameterPointManager** - å‚æ•°ç‚¹ç®¡ç†å™¨
- å‚æ•°ç‚¹çš„åˆ›å»ºã€æŸ¥è¯¢ã€åˆ é™¤
- å‚æ•°ç‚¹çš„ç¼“å­˜å’Œç®¡ç†
- æ‰¹é‡æ“ä½œæ”¯æŒ

âœ… **GripManager** - å¤¹ç‚¹ç®¡ç†å™¨
- å‚æ•°å¤¹ç‚¹çš„åˆ›å»ºå’Œç®¡ç†
- å¤¹ç‚¹é«˜äº®æ˜¾ç¤ºåŠŸèƒ½
- å¤šç§å‚æ•°ç±»å‹çš„å¤¹ç‚¹æ”¯æŒ

è¿™äº›ç±»æä¾›äº†å®Œæ•´çš„åº•å±‚åŠŸèƒ½æ”¯æ’‘ï¼Œå¯ä»¥ç›´æ¥ç”¨äºæ’ä»¶å¼€å‘ã€‚

ğŸ‰ ç°åœ¨æ‚¨æ‹¥æœ‰äº†å®Œæ•´çš„æ’ä»¶æœåŠ¡å±‚å®ç°ï¼